<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>golang基础学习 | ACKNIGHT</title><meta name="author" content="ACKnight"><meta name="copyright" content="ACKnight"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="Golang代理1GOPROXY&#x3D;https:&#x2F;&#x2F;goproxy.cn,direct  注释12345&#x2F;&#x2F; 单行注释&#x2F;*多行注释*&#x2F;  快捷键 ctrl + &#x2F; 转义字符go的字符串只能使用双引号，所以想在字符串中显示单引号，那么就得使用转义字符 如果想要输出 “hello world” 1fmt.Println(&quot;\&quot;hello world\&quot;&quot;)  go">
<meta property="og:type" content="article">
<meta property="og:title" content="golang基础学习">
<meta property="og:url" content="http://example.com/2025/10/27/golang%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/index.html">
<meta property="og:site_name" content="ACKNIGHT">
<meta property="og:description" content="Golang代理1GOPROXY&#x3D;https:&#x2F;&#x2F;goproxy.cn,direct  注释12345&#x2F;&#x2F; 单行注释&#x2F;*多行注释*&#x2F;  快捷键 ctrl + &#x2F; 转义字符go的字符串只能使用双引号，所以想在字符串中显示单引号，那么就得使用转义字符 如果想要输出 “hello world” 1fmt.Println(&quot;\&quot;hello world\&quot;&quot;)  go">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/1738847010729.jpg">
<meta property="article:published_time" content="2025-10-27T14:07:19.000Z">
<meta property="article:modified_time" content="2025-10-27T14:08:40.197Z">
<meta property="article:author" content="ACKnight">
<meta property="article:tag" content="golang">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/1738847010729.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "golang基础学习",
  "url": "http://example.com/2025/10/27/golang%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/",
  "image": "http://example.com/img/1738847010729.jpg",
  "datePublished": "2025-10-27T14:07:19.000Z",
  "dateModified": "2025-10-27T14:08:40.197Z",
  "author": [
    {
      "@type": "Person",
      "name": "ACKnight",
      "url": "http://example.com/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/Image_1548676214149460.jpg"><link rel="canonical" href="http://example.com/2025/10/27/golang%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":true,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'golang基础学习',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/1738843397175.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/Image_1548676214149460.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">6</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 链接</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://acknight-cast.oss-cn-guangzhou.aliyuncs.com/1738843397236.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">ACKNIGHT</span></a><a class="nav-page-title" href="/"><span class="site-name">golang基础学习</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 链接</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">golang基础学习</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-10-27T14:07:19.000Z" title="发表于 2025-10-27 22:07:19">2025-10-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-10-27T14:08:40.197Z" title="更新于 2025-10-27 22:08:40">2025-10-27</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/golang/">golang</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">14.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>63分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h3 id="Golang代理"><a href="#Golang代理" class="headerlink" title="Golang代理"></a>Golang代理</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GOPROXY=https://goproxy.cn,direct</span><br></pre></td></tr></table></figure>

<h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 单行注释</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">多行注释</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p>快捷键 <code>ctrl + /</code></p>
<h3 id="转义字符"><a href="#转义字符" class="headerlink" title="转义字符"></a>转义字符</h3><p>go的字符串只能使用双引号，所以想在字符串中显示单引号，那么就得使用转义字符</p>
<p>如果想要输出 “hello world”</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fmt.Println(<span class="string">&quot;\&quot;hello world\&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>go支持反引号</p>
<p>反引号引起来的字符串就不支持转义</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fmt.Println(<span class="string">`&quot;Hello World&quot;`</span>)</span><br></pre></td></tr></table></figure>

<p>go中引号的区别</p>
<ol>
<li>双引号表示一个字符串，双引号内字符可以转义，比如：\n，\r</li>
<li>单引号只能用来包裹一个字节的ASCII码字符，比如：<code>var a int = &#39;中&#39;</code></li>
<li>反引号引起来的字符串就不支持转义</li>
</ol>
<h4 id="其他常用转义字符"><a href="#其他常用转义字符" class="headerlink" title="其他常用转义字符"></a>其他常用转义字符</h4><table>
<thead>
<tr>
<th>“</th>
<th>双引号</th>
</tr>
</thead>
<tbody><tr>
<td>\</td>
<td>反斜线</td>
</tr>
<tr>
<td>\a</td>
<td>报警声</td>
</tr>
<tr>
<td>\b</td>
<td>退格</td>
</tr>
<tr>
<td>\f</td>
<td>换页</td>
</tr>
<tr>
<td>\n</td>
<td>换行</td>
</tr>
<tr>
<td>\r</td>
<td>回车替换</td>
</tr>
<tr>
<td>\v</td>
<td>垂直制表符</td>
</tr>
<tr>
<td>\t</td>
<td>制表符</td>
</tr>
</tbody></table>
<h4 id="格式化字符串"><a href="#格式化字符串" class="headerlink" title="格式化字符串"></a>格式化字符串</h4><p>在使用fmt中的Println的时候，有没有发现除了这个函数，还有好几个函数</p>
<p>Print 函数直接输出内容</p>
<p>Printf 格式化输出字符串</p>
<p>Println 会在输出内容的结尾添加一个换行符</p>
<p>Printf和Println是用到最多的输出</p>
<p>其中Printf中的格式化字符串特别多，很多都是用不到的，所以重点讲几个</p>
<table>
<thead>
<tr>
<th>%v</th>
<th>按值的本来值输出</th>
</tr>
</thead>
<tbody><tr>
<td>%+v</td>
<td>在 %v 基础上，对结构体字段名和值进行展开</td>
</tr>
<tr>
<td>%#v</td>
<td>输出 Go 语言语法格式的值</td>
</tr>
<tr>
<td>%T</td>
<td>输出 Go 语言语法格式的类型和值</td>
</tr>
<tr>
<td>%%</td>
<td>输出 % 本体</td>
</tr>
<tr>
<td>%b（oOdxX）</td>
<td>整型的不同进制方式显示</td>
</tr>
<tr>
<td>%U</td>
<td>Unicode 字符</td>
</tr>
<tr>
<td>%s</td>
<td>字符串</td>
</tr>
<tr>
<td>%d</td>
<td>整数</td>
</tr>
<tr>
<td>%f</td>
<td>浮点数</td>
</tr>
<tr>
<td>%p</td>
<td>指针，十六进制方式显示</td>
</tr>
</tbody></table>
<h3 id="变量定义"><a href="#变量定义" class="headerlink" title="变量定义"></a>变量定义</h3><h4 id="变量声明"><a href="#变量声明" class="headerlink" title="变量声明"></a>变量声明</h4><p>在go中，声明变量就必须使用</p>
<p>对于int类型，它的默认值就是0</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">// 1.先声明，再赋值</span></span><br><span class="line">	<span class="keyword">var</span> name <span class="type">string</span></span><br><span class="line">	name = <span class="string">&quot;AcKnight&quot;</span></span><br><span class="line">	fmt.Println(name)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 声明并赋值</span></span><br><span class="line">	<span class="keyword">var</span> name1 <span class="type">string</span> = <span class="string">&quot;AcKnight&quot;</span></span><br><span class="line">	fmt.Println(name1)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 省略类型</span></span><br><span class="line">	<span class="keyword">var</span> name2 = <span class="string">&quot;AcKnight&quot;</span></span><br><span class="line">	fmt.Println(name2)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//声明并赋值 短声明符号 :=</span></span><br><span class="line">	name3 := <span class="string">&quot;AcKnight&quot;</span></span><br><span class="line">	fmt.Println(name3)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="批量声明"><a href="#批量声明" class="headerlink" title="批量声明"></a>批量声明</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> (</span><br><span class="line">	v1 <span class="type">int</span></span><br><span class="line">	v2 <span class="type">int</span> = <span class="number">2</span></span><br><span class="line">	v3     = <span class="number">3</span></span><br><span class="line">)</span><br><span class="line">fmt.Printf(<span class="string">&quot;v1=%v, v2=%v, v3=%v&quot;</span>, v1, v2, v3)</span><br></pre></td></tr></table></figure>

<h4 id="常量Constant"><a href="#常量Constant" class="headerlink" title="常量Constant"></a>常量Constant</h4><p>声明之后不能修改</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> a <span class="type">int</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">fmt.Println(a)</span><br></pre></td></tr></table></figure>

<h4 id="iota"><a href="#iota" class="headerlink" title="iota"></a>iota</h4><p>批量声明常量就可以使用iota</p>
<p>它可以实现常量的计数功能</p>
<p>iota就是当前变量的层数</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> (</span><br><span class="line">    a <span class="type">int</span> = <span class="literal">iota</span></span><br><span class="line">    b     = <span class="number">2</span></span><br><span class="line">    c     = <span class="literal">iota</span></span><br><span class="line">    d     = <span class="literal">iota</span></span><br><span class="line">    e     = <span class="number">1</span></span><br><span class="line">    f     = <span class="literal">iota</span></span><br><span class="line">)</span><br><span class="line">fmt.Println(a, b, c, d, e, f)</span><br><span class="line"><span class="comment">// 0 2 2 3 1 5</span></span><br><span class="line"><span class="keyword">const</span> (</span><br><span class="line">    g = <span class="literal">iota</span></span><br><span class="line">    h = <span class="literal">iota</span></span><br><span class="line">)</span><br><span class="line">fmt.Println(g, h)</span><br><span class="line"><span class="comment">// 0 1</span></span><br></pre></td></tr></table></figure>

<h4 id="全局变量"><a href="#全局变量" class="headerlink" title="全局变量"></a>全局变量</h4><p>将变量声明放在函数之外</p>
<p>声明为全局变量之后，该变量可以不使用</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  fmt.Println(a)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="全局挎包变量"><a href="#全局挎包变量" class="headerlink" title="全局挎包变量"></a>全局挎包变量</h4><p>在当前项目中创建一个version目录，在version目录中创建version.go</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> version</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">  Version <span class="type">int</span>  = <span class="number">2</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>在主程序中就可以引入该包进行使用</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;go_study/version&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  fmt.Println(version.Version)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果要使用跨包变量，则需要将该变量名首字母大写</p>
<h3 id="基本数据类型"><a href="#基本数据类型" class="headerlink" title="基本数据类型"></a>基本数据类型</h3><p>Golang中所有的值类型变量常量都会在声明时被分配内存空间并赋予默认值</p>
<p>数字型 0</p>
<p>布尔型 false</p>
<p>字符串 “”</p>
<p>bit：比特位，二进制中的一位，信息的最小单位</p>
<p>byte：字节，1byte&#x3D;8bit，在Go中是uint8的别名</p>
<h4 id="整数型"><a href="#整数型" class="headerlink" title="整数型"></a>整数型</h4><p>int: 整数 integer</p>
<table>
<thead>
<tr>
<th>0</th>
<th>1</th>
<th>0</th>
<th>1</th>
<th>0</th>
<th>1</th>
</tr>
</thead>
</table>
<p>第一位用于存放正负</p>
<p>范围 -128 ~ 127</p>
<p>uint: 无符号整数 unsigned integer</p>
<table>
<thead>
<tr>
<th>1</th>
<th>1</th>
<th>0</th>
<th>1</th>
<th>0</th>
<th>1</th>
</tr>
</thead>
</table>
<p>范围：0~255</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>长度</th>
<th>范围</th>
</tr>
</thead>
<tbody><tr>
<td>int8</td>
<td>8bit</td>
<td>-128 ~ 127</td>
</tr>
<tr>
<td>uint8</td>
<td>8bit</td>
<td>0 ~ 255</td>
</tr>
<tr>
<td>int16</td>
<td>16bit</td>
<td>-32768 ~ 32767</td>
</tr>
<tr>
<td>uint16</td>
<td>16bit</td>
<td>0 ~ 65536</td>
</tr>
<tr>
<td>int32</td>
<td>32bit</td>
<td></td>
</tr>
<tr>
<td>uint32</td>
<td>32bit</td>
<td></td>
</tr>
<tr>
<td>int64</td>
<td>64bit</td>
<td></td>
</tr>
<tr>
<td>uint64</td>
<td>64bit</td>
<td></td>
</tr>
<tr>
<td>int</td>
<td>32 &#x2F; 64bit</td>
<td></td>
</tr>
<tr>
<td>uint</td>
<td>32 &#x2F; 64bit</td>
<td></td>
</tr>
</tbody></table>
<p>int会根据操作系统自动来判断是int32或int64</p>
<p>decimal：十进制，无需前缀</p>
<p>binary: 二进制，前缀0b、0B</p>
<p>octal：八进制，前缀0o、0O</p>
<p>hexadecimal：十六进制，前缀0X、0x</p>
<h4 id="浮点型"><a href="#浮点型" class="headerlink" title="浮点型"></a>浮点型</h4><p>byte uint8的别名</p>
<p>rune uint32的别名</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> (</span><br><span class="line">  c1 <span class="type">byte</span> = <span class="number">65</span></span><br><span class="line">  c2      = <span class="string">&#x27;a&#x27;</span></span><br><span class="line">  c3 <span class="type">rune</span> = <span class="string">&#x27;中&#x27;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">fmt.Printf(<span class="string">&quot;c1 的码值=%v, 字符为：%c, 类型是%T\n&quot;</span>, c1, c1, c1)</span><br><span class="line">fmt.Printf(<span class="string">&quot;c2 的码值=%v, 字符为：%c, 类型是%T\n&quot;</span>, c2, c2, c2)</span><br><span class="line">fmt.Printf(<span class="string">&quot;c3 的码值=%v, 字符为：%c, 类型是%T\n&quot;</span>, c3, c3, c3)</span><br></pre></td></tr></table></figure>

<h4 id="布尔型"><a href="#布尔型" class="headerlink" title="布尔型"></a>布尔型</h4><p>bool true false</p>
<p>字符串型</p>
<p>string</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s <span class="type">string</span> = <span class="string">&quot;Hello&quot;</span></span><br><span class="line">fmt.Printf(<span class="string">&quot;s=%v, type is %T&quot;</span>, s, s)CopyErrorOK!</span><br></pre></td></tr></table></figure>

<p>求字符串个数</p>
<p>len(str)</p>
<h3 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h3><p><code>+</code>，<code>-</code>，<code>*</code>，<code>/</code>，<code>%</code></p>
<p><code>++</code></p>
<p>没有次方 ^ 异或</p>
<p>go没有前++，只有<code>后++</code></p>
<h4 id="位运算符"><a href="#位运算符" class="headerlink" title="位运算符"></a>位运算符</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> b <span class="type">uint8</span> = <span class="number">0</span>b00111100</span><br><span class="line"></span><br><span class="line"><span class="comment">// 往右移两位</span></span><br><span class="line">fmt.Printf(<span class="string">&quot;b&gt;&gt;2:%b\n&quot;</span>, b&gt;&gt;<span class="number">2</span>)</span><br><span class="line"><span class="comment">// 0b00001111</span></span><br><span class="line"><span class="comment">// 往左移两位</span></span><br><span class="line">fmt.Printf(<span class="string">&quot;b&lt;&lt;2:%b\n&quot;</span>, b&lt;&lt;<span class="number">2</span>)</span><br><span class="line"><span class="comment">// 0b111100</span></span><br></pre></td></tr></table></figure>

<p><code>&amp;</code> 按位<code>与</code> 全1为1</p>
<p><code>|</code> 按位<code>或</code> 有1为1</p>
<p><code>^</code> 按位<code>异或</code> 相同为0 不同为1</p>
<h4 id="赋值运算符"><a href="#赋值运算符" class="headerlink" title="赋值运算符"></a>赋值运算符</h4><p>+&#x3D;</p>
<p>-&#x3D;</p>
<p>*&#x3D;</p>
<p>&#x2F;&#x3D;</p>
<p>…</p>
<h4 id="关系运算符"><a href="#关系运算符" class="headerlink" title="关系运算符"></a>关系运算符</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;</span><br><span class="line">&gt;=</span><br><span class="line">&lt;</span><br><span class="line">&lt;=</span><br><span class="line">==</span><br><span class="line">!=</span><br></pre></td></tr></table></figure>

<h4 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&amp;&amp;  与</span><br><span class="line">||  或</span><br><span class="line">!   非</span><br></pre></td></tr></table></figure>

<p>逻辑运算符只针对于布尔类型的数据值 或者表达式使用</p>
<h4 id="逻辑短路"><a href="#逻辑短路" class="headerlink" title="逻辑短路"></a>逻辑短路</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//因为0不能作为除数的特性 ，我们这里使用0来进行举证。</span></span><br><span class="line">a,b:=<span class="number">10</span>,<span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> a&gt;<span class="number">0</span> || a/b&gt;<span class="number">0</span>&#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;OK&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个时候 || 左边为true 右边会报错 而或[||] 只要有一个为true即可满足条件<br>这个时候 我们是可以看到OK的输出的 而没有报错<br>如果改为a&lt;0 左边的判断条件为false 就会接着去执行右边的表达式 此时报错 而OK也无法输出<br>代码：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//因为0不能作为除数的特性 ，我们这里使用0来进行举证。</span></span><br><span class="line">a,b:=<span class="number">10</span>,<span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> a&gt;<span class="number">0</span> &amp;&amp; a/b&gt;<span class="number">0</span>&#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;OK&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>同真为真 其余为假 根据这个特性 我们就可以推导 和上面的短路或 有一些相似<br>而他是在其中有一个是false的情况下 即我们得出左边的值是false 那么程序就会直接输出OK 不会报右边除于0的错误<br>上述举例中，a&gt;0为true 这种情况下 还会继续向右执行 这个时候是报错的</p>
<h4 id="地址运算符"><a href="#地址运算符" class="headerlink" title="地址运算符"></a>地址运算符</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&amp;  取地址</span><br><span class="line">*  取地址对应的值</span><br></pre></td></tr></table></figure>

<p>Golang中所有的值类型变量常量都会在声明时被分配内存空间并赋予默认值</p>
<p>数字型 0</p>
<p>布尔型 false</p>
<p>字符串 “”</p>
<p>bit：比特位，二进制中的一位，信息的最小单位</p>
<p>byte：字节，1byte&#x3D;8bit，在Go中是uint8的别名</p>
<h3 id="判断语句"><a href="#判断语句" class="headerlink" title="判断语句"></a>判断语句</h3><h4 id="if-else"><a href="#if-else" class="headerlink" title="if else"></a>if else</h4><p>和其他语言没什么区别</p>
<ol>
<li>条件不用加括号，加括号也不会报错</li>
<li>编码风格</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">fmt.Println(<span class="string">&quot;请输入你的年龄&quot;</span>)</span><br><span class="line"><span class="keyword">var</span> age <span class="type">uint8</span></span><br><span class="line">fmt.Scanln(&amp;age)</span><br><span class="line"><span class="keyword">if</span> age &lt; <span class="number">13</span> &#123;</span><br><span class="line">  fmt.Println(<span class="string">&quot;年龄小于13&quot;</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  fmt.Println(<span class="string">&quot;年龄大于13&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>需要注意的是，<strong>if后面的左大括号，必须和if在同一行</strong></p>
<p>这种语法是不被编译通过的</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> age <span class="type">uint8</span> = <span class="number">12</span></span><br><span class="line"><span class="keyword">if</span> age &lt; <span class="number">13</span> </span><br><span class="line">&#123;</span><br><span class="line">  fmt.Println(<span class="string">&quot;年龄小于13&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="if-else-if"><a href="#if-else-if" class="headerlink" title="if else if"></a>if else if</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">fmt.Println(<span class="string">&quot;请输入你的年龄&quot;</span>)</span><br><span class="line"><span class="keyword">var</span> age <span class="type">uint8</span></span><br><span class="line">fmt.Scanln(&amp;age)</span><br><span class="line"><span class="keyword">if</span> age &lt; <span class="number">13</span> &#123;</span><br><span class="line">  fmt.Println(<span class="string">&quot;年龄小于13&quot;</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> age &lt; <span class="number">25</span> &#123;</span><br><span class="line">  fmt.Println(<span class="string">&quot;年龄小于25&quot;</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  fmt.Println(<span class="string">&quot;年龄大于25&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="if-简短语句"><a href="#if-简短语句" class="headerlink" title="if 简短语句"></a>if 简短语句</h4><p>在进行判断的之前，可以声明变量，用于接收函数返回值并判断</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> i:=<span class="number">3</span>;i&gt;<span class="number">0</span>&#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;大于0&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="switch-case"><a href="#switch-case" class="headerlink" title="switch case"></a>switch case</h4><p>可以直接将if else改写为switch case</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">fmt.Println(<span class="string">&quot;请输入你的年龄&quot;</span>)</span><br><span class="line"><span class="keyword">var</span> age <span class="type">uint8</span></span><br><span class="line">fmt.Scanln(&amp;age)</span><br><span class="line"><span class="keyword">switch</span> &#123;</span><br><span class="line">  <span class="keyword">case</span> age &lt; <span class="number">13</span>:</span><br><span class="line">    fmt.Println(<span class="string">&quot;年龄小于13&quot;</span>)</span><br><span class="line">    <span class="keyword">fallthrough</span></span><br><span class="line">  <span class="keyword">case</span> age &lt; <span class="number">25</span>:</span><br><span class="line">    fmt.Println(<span class="string">&quot;年龄小于25&quot;</span>)</span><br><span class="line">  <span class="keyword">default</span>:</span><br><span class="line">    fmt.Println(<span class="string">&quot;年龄大于25&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>fallthrough</code>是用于case穿透</p>
<p><code>break</code>是退出当前switch，默认每个case后都有break</p>
<p><strong>第二种用法</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">fmt.Println(<span class="string">&quot;请输入星期（数字）&quot;</span>)</span><br><span class="line"><span class="keyword">var</span> weekDay <span class="type">uint8</span></span><br><span class="line">fmt.Scanln(&amp;weekDay)</span><br><span class="line"><span class="keyword">switch</span> weekDay &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">  fmt.Println(<span class="string">&quot;酱油拌饭&quot;</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">  fmt.Println(<span class="string">&quot;蛋炒饭&quot;</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">  fmt.Println(<span class="string">&quot;阳春面&quot;</span>)</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">  fmt.Println(<span class="string">&quot;西北风&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="switch-case与if-else区别"><a href="#switch-case与if-else区别" class="headerlink" title="switch case与if else区别"></a>switch case与if else区别</h4><p>if else是多个条件选一个，只要成立了一个，后面的就都不会去匹配了</p>
<p>switch的每一个case是从上到下去匹配，如果没有break，则每一个都会去匹配</p>
<h3 id="for-循环"><a href="#for-循环" class="headerlink" title="for 循环"></a>for 循环</h3><h4 id="无线循环"><a href="#无线循环" class="headerlink" title="无线循环"></a>无线循环</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">i := <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">  fmt.Println(i)</span><br><span class="line">  i++</span><br><span class="line">  <span class="keyword">if</span> i == <span class="number">10</span> &#123;</span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="条件循环"><a href="#条件循环" class="headerlink" title="条件循环"></a>条件循环</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">i := <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i &lt;= <span class="number">10</span> &#123;</span><br><span class="line">  fmt.Println(i)</span><br><span class="line">  i++</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="标准循环"><a href="#标准循环" class="headerlink" title="标准循环"></a>标准循环</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= <span class="number">10</span>; i++ &#123;</span><br><span class="line">  fmt.Println(i)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意点：<strong>for语句后面的三个构成部分不能加括号，会报错</strong></p>
<h4 id="break"><a href="#break" class="headerlink" title="break"></a>break</h4><p>跳出当前循环</p>
<h4 id="continue"><a href="#continue" class="headerlink" title="continue"></a>continue</h4><p>结束本次循环</p>
<p>continue后面的代码就不会执行了</p>
<p>九九乘法表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= <span class="number">9</span>; i++ &#123;</span><br><span class="line">  <span class="keyword">for</span> j := <span class="number">1</span>; j &lt;= i; j++ &#123;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;%d * %d = %d  &quot;</span>, j, j, i*j)</span><br><span class="line">  &#125;</span><br><span class="line">  fmt.Println()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="label和goto"><a href="#label和goto" class="headerlink" title="label和goto"></a>label和goto</h3><p>Go 语言中有 <code>goto</code> 这个功能，这个功能会影响代码的可读性， 会让代码结构看起来比较乱。</p>
<p>Go语言也支持label(标签)语法：分别是<code>break label</code>和 <code>goto label</code> 、<code>continue label</code></p>
<h4 id="break-1"><a href="#break-1" class="headerlink" title="break"></a>break</h4><p>break 一般用来跳出当前所在的循环， 但是我们有业务场景，需要使用到 跳出最外层循环怎么办？<code>break label</code> 跳出循环不再执行for循环里的代码。</p>
<p>label一般用于跳出多层循环</p>
<p><code>break</code>标签只能用于<code>for</code>循环，不能和<code>switch</code>使用，在其他语言里<code>switch</code>与<code>break</code>是搭档</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">label:</span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= <span class="number">10</span>; i++ &#123;</span><br><span class="line">    <span class="keyword">for</span> j := <span class="number">1</span>; j &lt;= <span class="number">5</span>; j++ &#123;</span><br><span class="line">      <span class="keyword">if</span> i == <span class="number">8</span> &amp;&amp; j == <span class="number">4</span> &#123;</span><br><span class="line">        <span class="keyword">break</span> label</span><br><span class="line">      &#125;</span><br><span class="line">      fmt.Print(<span class="string">&quot;+&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Print(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="continue-1"><a href="#continue-1" class="headerlink" title="continue"></a>continue</h4><p><code>continue label</code> 这个功能和 <code>break</code> 优点类似，区别在于  <code>break</code> 是强制终止， <code>continue</code> 是继续循环下一个迭代。</p>
<h4 id="goto"><a href="#goto" class="headerlink" title="goto"></a>goto</h4><p>goto 可以无条件的跳转执行的位置，但是<strong>不能跨函数</strong>，需要配合标签使用。</p>
<p><code>goto</code> 标签放上面，下面都可以的.</p>
<p>用goto实现循环</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name <span class="type">string</span></span><br><span class="line">start:</span><br><span class="line">  fmt.Println(<span class="string">&quot;请输入你的名字:&quot;</span>)</span><br><span class="line"></span><br><span class="line">  fmt.Scanln(&amp;name)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> name != <span class="string">&quot;AcKnight&quot;</span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;名字输入错误！&quot;</span>)</span><br><span class="line">    <span class="keyword">goto</span> start</span><br><span class="line">  &#125;</span><br><span class="line">  fmt.Println(<span class="string">&quot;名字输入正确！&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>不建议使用，容易造成逻辑混乱</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  fmt.Println(<span class="number">1</span>)</span><br><span class="line">  <span class="keyword">if</span> i := <span class="number">1</span>; i == <span class="number">1</span> &#123;</span><br><span class="line">    <span class="keyword">goto</span> four</span><br><span class="line">  &#125;</span><br><span class="line">  fmt.Println(<span class="number">2</span>)</span><br><span class="line">  fmt.Println(<span class="number">3</span>)</span><br><span class="line">four:</span><br><span class="line">  fmt.Println(<span class="number">4</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><p>标准的函数写法</p>
<p>参数 参数类型 返回的类型</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getSum</span><span class="params">(n1 <span class="type">int</span>, n2 <span class="type">int</span>)</span></span> <span class="type">int</span>&#123;</span><br><span class="line">    sum := n1 + n2</span><br><span class="line">    <span class="keyword">return</span> sum</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    res := getSum(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">    fmt.Println(res)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>实参：给函数实际传递的参数，例如上面的1，2</p>
<p>形参：形式上的参数，例如上面的n1和n2</p>
<h4 id="返回值"><a href="#返回值" class="headerlink" title="返回值"></a>返回值</h4><p>golang函数支持返回多个返回值</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getRes</span><span class="params">(n1 <span class="type">int</span>, n2 <span class="type">int</span>)</span></span> (<span class="type">int</span>, <span class="type">int</span>) &#123;</span><br><span class="line">  sum := n1 + n2</span><br><span class="line">  difference := n1 - n2</span><br><span class="line">  <span class="keyword">return</span> sum, difference</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>两个及以上的返回值，上面类型要加括号</p>
<h4 id="返回值命名"><a href="#返回值命名" class="headerlink" title="返回值命名"></a>返回值命名</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getRes</span><span class="params">(n1, n2 <span class="type">int</span>)</span></span> (sum, difference <span class="type">int</span>) &#123;</span><br><span class="line">  sum = n1 + n2</span><br><span class="line">  difference = n1 - n2</span><br><span class="line">  <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="函数也是一种数据类型"><a href="#函数也是一种数据类型" class="headerlink" title="函数也是一种数据类型"></a>函数也是一种数据类型</h4><p>函数不是变量，但他也存在与内存中，存在内存地址</p>
<p>函数名的本质就是一个指向其函数内存地址的指针常量</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getRes</span><span class="params">(n1, n2 <span class="type">int</span>)</span></span> (sum, difference <span class="type">int</span>) &#123;</span><br><span class="line">  sum = n1 + n2</span><br><span class="line">  difference = n1 - n2</span><br><span class="line">  <span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  fmt.Printf(<span class="string">&quot;getRes is %v, type is %T&quot;</span>, getRes, getRes)</span><br><span class="line">  <span class="comment">//getRes is 0x4aca00, type is func(int, int) (int, int)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>所以，我们也可以以声明变量的形式声明函数</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> getRes = <span class="function"><span class="keyword">func</span><span class="params">(n1, n2 <span class="type">int</span>)</span></span> (sum, difference <span class="type">int</span>) &#123;</span><br><span class="line">  sum = n1 + n2</span><br><span class="line">  difference = n1 - n2</span><br><span class="line">  <span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">a, b := getRes(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">fmt.Println(a, b)</span><br></pre></td></tr></table></figure>

<p>getRes 对应的那个函数也叫匿名函数</p>
<h4 id="立即调用的匿名函数"><a href="#立即调用的匿名函数" class="headerlink" title="立即调用的匿名函数"></a>立即调用的匿名函数</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a, b := <span class="function"><span class="keyword">func</span><span class="params">(n1, n2 <span class="type">int</span>)</span></span> (sum, difference <span class="type">int</span>) &#123;</span><br><span class="line">  sum = n1 + n2</span><br><span class="line">  difference = n1 - n2</span><br><span class="line">  <span class="keyword">return</span></span><br><span class="line">&#125;(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">fmt.Println(a, b)</span><br></pre></td></tr></table></figure>

<h3 id="指针"><a href="#指针" class="headerlink" title="指针"></a>指针</h3><p>在弄懂什么是指针之前</p>
<p>先弄清楚什么是值传递，什么是引用传递</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">add</span><span class="params">(n <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">  n++</span><br><span class="line">  fmt.Println(<span class="string">&quot;add函数结束时：&quot;</span>, n)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">var</span> y = <span class="number">2022</span></span><br><span class="line">  add(y)</span><br><span class="line">  fmt.Println(<span class="string">&quot;调用add函数之后：&quot;</span>, y)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到函数调用结束之后，y的值还是2022</p>
<p>这就是说明函数传递默认是值传递</p>
<p>我们可以使用&amp;可以获取某个变量的内存地址</p>
<p>用*获取到内存地址所对应的值</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">add</span><span class="params">(n *<span class="type">int</span>)</span></span> &#123;</span><br><span class="line">  *n++</span><br><span class="line">  fmt.Println(<span class="string">&quot;add函数结束时：&quot;</span>, n, *n)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">var</span> y = <span class="number">2022</span></span><br><span class="line">  <span class="keyword">var</span> yy = &amp;y</span><br><span class="line">  add(yy)</span><br><span class="line">  fmt.Println(<span class="string">&quot;调用add函数之后：&quot;</span>, y, &amp;y)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="defer"><a href="#defer" class="headerlink" title="defer"></a>defer</h3><ol>
<li>延迟执行的函数会被压入栈中，return后按照先进后出的顺序调用</li>
<li>延迟执行的函数其参数会立即求值</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">deferUtil</span><span class="params">()</span></span> <span class="function"><span class="keyword">func</span><span class="params">(<span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">  i := <span class="number">0</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(n <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;本次调用接收到n=%v\n&quot;</span>, n)</span><br><span class="line">    i++</span><br><span class="line">    fmt.Printf(<span class="string">&quot;匿名工具函数第%v次被调用\n&quot;</span>, i)</span><br><span class="line">    <span class="keyword">return</span> i</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Defer</span><span class="params">()</span></span> <span class="type">int</span> &#123;</span><br><span class="line">  f := deferUtil()</span><br><span class="line">  <span class="comment">//f(1)</span></span><br><span class="line">  <span class="keyword">defer</span> f(<span class="number">1</span>)</span><br><span class="line">  <span class="comment">//defer f(f(3))</span></span><br><span class="line">  <span class="keyword">return</span> f(<span class="number">2</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  Defer()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">本次调用接收到n=2</span><br><span class="line">匿名工具函数第1次被调用</span><br><span class="line">本次调用接收到n=1</span><br><span class="line">匿名工具函数第2次被调用</span><br></pre></td></tr></table></figure>

<p>可用于函数异常捕获</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Defer</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">    err := <span class="built_in">recover</span>()</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      fmt.Println(err)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;()</span><br><span class="line">  n := <span class="number">0</span></span><br><span class="line">  fmt.Println(<span class="number">3</span> / n)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  Defer()</span><br><span class="line">  fmt.Println(<span class="string">&quot;Defer函数之后运行&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">runtime error: integer divide by zero</span><br><span class="line">Defer函数之后运行</span><br></pre></td></tr></table></figure>

<h3 id="init函数"><a href="#init函数" class="headerlink" title="init函数"></a>init函数</h3><ol>
<li>init函数可以在所有程序执行开始前被调用，并且每个包下可以有多个init函数</li>
<li>init函数先于main函数自动执行</li>
<li>每个包中可以有多个init函数，每个包中的源文件中也可以有多个init函数</li>
<li>init函数没有输入参数、返回值，也未声明，所以无法引用</li>
<li>不同包的init函数按照包导入的依赖关系决定执行顺序</li>
<li>无论包被导入多少次，init函数只会被调用一次，也就是只执行一次</li>
<li>init函数在代码中不能被显示的调用，不能被引用（赋值给函数变量），否则会出现编译错误</li>
<li>Go程序仅仅想要用一个package的init执行，我们可以这样使用：import _ “test_xxxx”，导入包的时候加上下划线就ok了</li>
<li>init函数不应该依赖任何在main函数里创建的变量，因为init函数的执行是在main函数之前的</li>
</ol>
<p><strong>执行顺序</strong></p>
<p>被依赖的全局变量&gt;&gt;被依赖包的init函数&gt;&gt;…&gt;&gt;main包的全局变量&gt;&gt;main的init函数&gt;&gt;main函数</p>
<p><strong>init函数可以做什么</strong></p>
<p>初始化操作</p>
<h3 id="包"><a href="#包" class="headerlink" title="包"></a>包</h3><p>注意点</p>
<ol>
<li>一个包就是一个目录，包名和目录名一致</li>
</ol>
<h4 id="包的导入"><a href="#包的导入" class="headerlink" title="包的导入"></a>包的导入</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;go_study/pkg&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  pkg.Pkg()</span><br><span class="line">  fmt.Println(<span class="string">&quot;xxx&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="简写"><a href="#简写" class="headerlink" title="简写"></a>简写</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;go_study/pkg&quot;</span></span><br><span class="line">)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  pkg.Pkg()</span><br><span class="line">  fmt.Println(<span class="string">&quot;xxx&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="起别名"><a href="#起别名" class="headerlink" title="起别名"></a>起别名</h4><p>如果有两个一样的包，那么在导入的时候就可以起一个别名</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  pkg01 <span class="string">&quot;go_study/pkg&quot;</span></span><br><span class="line">  pkg02 <span class="string">&quot;go_study/pkg&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  pkg01.Pkg()</span><br><span class="line">  pkg02.Pkg()</span><br><span class="line">  fmt.Println(<span class="string">&quot;xxx&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="全部引入"><a href="#全部引入" class="headerlink" title="全部引入"></a>全部引入</h4><p>我们在使用包中的函数、变量的时候，通常都是包名点变量名这样，如果想直接使用变量名，那么需要将包中的内容全部导入</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  . <span class="string">&quot;go_study/pkg&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  Pkg()</span><br><span class="line">  fmt.Println(<span class="string">&quot;xxx&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是这样做会有一些问题，一般是不建议的</p>
<p>如果在当前包中，有重名的函数名或变量，则会编译失败</p>
<h4 id="下划线"><a href="#下划线" class="headerlink" title="下划线_"></a>下划线_</h4><p>引入某个包，但不直接使用包里的函数，而是调用该包里面的init函数</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  _ <span class="string">&quot;go_study/pkg&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  fmt.Println(<span class="string">&quot;xxx&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr [<span class="number">3</span>]<span class="type">int</span> = [<span class="number">3</span>]<span class="type">int</span>&#123;<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>&#125;</span><br></pre></td></tr></table></figure>

<p>长度不能为空</p>
<p>可以使用…自动推导数组的长度</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [...]<span class="type">int</span>&#123;<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>&#125;</span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">var</span> arr1 [<span class="number">3</span>]<span class="type">int</span> = [<span class="number">3</span>]<span class="type">int</span>&#123;<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>&#125;</span><br><span class="line">  <span class="keyword">var</span> arr2 = [...]<span class="type">int</span>&#123;<span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>&#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 索引</span></span><br><span class="line">  fmt.Println(arr1[<span class="number">0</span>])</span><br><span class="line">  fmt.Println(arr1[<span class="number">1</span>])</span><br><span class="line">  fmt.Println(arr1[<span class="number">2</span>])</span><br><span class="line">  <span class="comment">//fmt.Println(arr1[3])  // 超过索引范围会编译错误</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 修改元素</span></span><br><span class="line">  arr2[<span class="number">0</span>] = <span class="number">11</span></span><br><span class="line">  arr2[<span class="number">2</span>] = <span class="number">9</span></span><br><span class="line">  fmt.Println(arr2)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 遍历</span></span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(arr2); i++ &#123;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;arr2[%v]=%v\n&quot;</span>, i, arr2[i])</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 第二种遍历</span></span><br><span class="line">  <span class="keyword">for</span> index, value := <span class="keyword">range</span> arr2 &#123;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;arr2 index=%v, value=%v\n&quot;</span>, index, value)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>二维数组</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> t [<span class="number">3</span>][<span class="number">4</span>]<span class="type">int</span> = [<span class="number">3</span>][<span class="number">4</span>]<span class="type">int</span>&#123;</span><br><span class="line">    &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;,</span><br><span class="line">    &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;,</span><br><span class="line">    &#123;<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>&#125;,</span><br><span class="line">  &#125;</span><br><span class="line">fmt.Println(t)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i, v := <span class="keyword">range</span> t &#123;</span><br><span class="line">  <span class="keyword">for</span> i2, v2 := <span class="keyword">range</span> v &#123;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;a[%v][%v]=%v\t&quot;</span>, i, i2, v2)</span><br><span class="line">  &#125;</span><br><span class="line">  fmt.Println()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="切片"><a href="#切片" class="headerlink" title="切片"></a>切片</h3><p>使用数组的时候，会不会觉得数组不太灵活</p>
<p>所以golang为我们提供了一种切片</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">5</span>]<span class="type">int</span>&#123;<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>&#125;</span><br><span class="line"><span class="keyword">var</span> slice = arr[<span class="number">0</span>:<span class="number">5</span>] <span class="comment">// 切片的两边也是顾头不顾尾</span></span><br><span class="line">fmt.Println(slice)</span><br></pre></td></tr></table></figure>

<p>array[开始引用的index : 结束引用的index+1]</p>
<p>这里的slice是从arr中切片切出来的</p>
<p>：两边是顾头不顾尾（前闭后开）</p>
<p>左边不写默认是0</p>
<p>右边不写默认是最后一个</p>
<h4 id="切片不是对数组的引用"><a href="#切片不是对数组的引用" class="headerlink" title="切片不是对数组的引用"></a>切片不是对数组的引用</h4><p>如果改变切片中的元素，对应的数组也会变化</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">5</span>]<span class="type">int</span>&#123;<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>&#125;</span><br><span class="line"><span class="keyword">var</span> slice = arr[<span class="number">0</span>:<span class="number">5</span>]</span><br><span class="line">slice[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">fmt.Println(arr)</span><br></pre></td></tr></table></figure>

<h4 id="指向切片的切片"><a href="#指向切片的切片" class="headerlink" title="指向切片的切片"></a>指向切片的切片</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">5</span>]<span class="type">int</span>&#123;<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>&#125;</span><br><span class="line"><span class="keyword">var</span> slice = arr[<span class="number">0</span>:<span class="number">5</span>]</span><br><span class="line"><span class="keyword">var</span> s1 = slice[<span class="number">0</span>:<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">slice[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">fmt.Println(s1)</span><br><span class="line">fmt.Println(slice)</span><br><span class="line">fmt.Println(arr)</span><br></pre></td></tr></table></figure>

<p>切片是引用类型，默认值为nil</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s []<span class="type">int</span></span><br><span class="line">fmt.Println(s == <span class="literal">nil</span>)  <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p>遍历方式同数组</p>
<h4 id="分配内存空间"><a href="#分配内存空间" class="headerlink" title="分配内存空间"></a>分配内存空间</h4><p>使用make</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s []<span class="type">int</span></span><br><span class="line">s = <span class="built_in">make</span>([]<span class="type">int</span>, <span class="number">3</span>, <span class="number">5</span>) <span class="comment">// 创建一个长度为3， 容量为5的空间</span></span><br><span class="line">fmt.Println(s)        <span class="comment">// [0 0 0]</span></span><br></pre></td></tr></table></figure>

<p>容量不写，默认等于长度</p>
<p>查看长度和容量</p>
<p>len</p>
<p>cap</p>
<p>由系统自动创建底层数组</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s := []<span class="type">int</span>&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125;</span><br></pre></td></tr></table></figure>

<p>追加元素</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s1 := []<span class="type">int</span>&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125;</span><br><span class="line">s = <span class="built_in">append</span>(s1, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>) <span class="comment">// 底层创建了新的数组，不在应用原数组</span></span><br></pre></td></tr></table></figure>

<p>复制数组</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 复制</span></span><br><span class="line"><span class="keyword">var</span> s1 = <span class="built_in">make</span>([]<span class="type">int</span>, <span class="number">8</span>, <span class="number">8</span>)</span><br><span class="line"><span class="built_in">copy</span>(s1, s)  <span class="comment">// 将s复制到s1，复制的个数就是s1的容量大小</span></span><br><span class="line">fmt.Println(s1)</span><br></pre></td></tr></table></figure>

<p>string与 []byte</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">str := <span class="string">&quot;hello 世界&quot;</span></span><br><span class="line">fmt.Printf(<span class="string">&quot;[]byte(str)=%s\n&quot;</span>, []<span class="type">byte</span>(str))</span><br><span class="line">fmt.Printf(<span class="string">&quot;[]byte(str)=%v\n&quot;</span>, []<span class="type">byte</span>(str))</span><br><span class="line"><span class="comment">// 汉字被分成了三个数字</span></span><br><span class="line"><span class="keyword">for</span> i, v := <span class="keyword">range</span> str&#123;</span><br><span class="line">  fmt.Printf(<span class="string">&quot;str[%d]=%c\n&quot;</span>, i, v)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>函数参数接收多个值</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Sum</span><span class="params">(numList ...<span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">  sum := <span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> _, v := <span class="keyword">range</span> numList &#123;</span><br><span class="line">    sum += v</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> sum</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  sum := Sum(<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>)</span><br><span class="line">  fmt.Println(sum)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="map"><a href="#map" class="headerlink" title="map"></a>map</h3><p>map是key-value形式</p>
<p>它的key只能是基本数据类型</p>
<h4 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h4><p>定义并创建</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义map</span></span><br><span class="line"><span class="keyword">var</span> m <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span></span><br><span class="line"><span class="comment">// 创建空间</span></span><br><span class="line">m = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>, <span class="number">2</span>) <span class="comment">// size可以不写，默认为1</span></span><br><span class="line"></span><br><span class="line">m[<span class="string">&quot;name&quot;</span>] = <span class="string">&quot;张三&quot;</span></span><br><span class="line">m[<span class="string">&quot;age&quot;</span>] = <span class="string">&quot;21&quot;</span></span><br><span class="line">m[<span class="string">&quot;addr&quot;</span>] = <span class="string">&quot;湖南长沙&quot;</span></span><br><span class="line"></span><br><span class="line">fmt.Println(m)</span><br></pre></td></tr></table></figure>

<p>简写</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">m2 := <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>&#123;</span><br><span class="line">  <span class="string">&quot;name&quot;</span>: <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">  <span class="string">&quot;age&quot;</span>: <span class="string">&quot;12&quot;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="增加"><a href="#增加" class="headerlink" title="增加"></a>增加</h4><p>通过map[key] &#x3D; xxx</p>
<h4 id="查找"><a href="#查找" class="headerlink" title="查找"></a>查找</h4><p>通过双赋值检测某个key是否存在</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">v, ok := m2[<span class="string">&quot;name&quot;</span>]</span><br><span class="line"><span class="keyword">if</span> ok &#123;</span><br><span class="line">   <span class="comment">// 如果存在，ok就为true</span></span><br><span class="line">   fmt.Printf(<span class="string">&quot;v = %v&quot;</span>, v)</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">   fmt.Printf(<span class="string">&quot;v不存在&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">delete</span>(<span class="keyword">map</span>, key) <span class="comment">// 删除单个元素</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除所有的key-value</span></span><br><span class="line"><span class="comment">// 重新make</span></span><br></pre></td></tr></table></figure>

<h4 id="遍历"><a href="#遍历" class="headerlink" title="遍历"></a>遍历</h4><p>map只有len，没有cap</p>
<p>len一个map，得到的就是key的个数</p>
<p>只有for range一种遍历方式</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> key, value := <span class="keyword">range</span> m&#123;</span><br><span class="line">  fmt.Printf(<span class="string">&quot;key=%v,value=%v\n&quot;</span>, key, value)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="切片中的类型为map类型"><a href="#切片中的类型为map类型" class="headerlink" title="切片中的类型为map类型"></a>切片中的类型为map类型</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mapSlice = <span class="built_in">make</span>([]<span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>, <span class="number">3</span>)</span><br><span class="line"><span class="keyword">for</span> index, value := <span class="keyword">range</span> mapSlice &#123;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;index:%d value:%v\n&quot;</span>, index, value)</span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(<span class="string">&quot;初始化元素：&quot;</span>)</span><br><span class="line"><span class="comment">// 对切片中的map元素进行初始化</span></span><br><span class="line">mapSlice[<span class="number">0</span>] = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>)</span><br><span class="line">mapSlice[<span class="number">0</span>][<span class="string">&quot;name&quot;</span>] = <span class="string">&quot;小明&quot;</span></span><br><span class="line">mapSlice[<span class="number">0</span>][<span class="string">&quot;gender&quot;</span>] = <span class="string">&quot;男&quot;</span></span><br><span class="line">mapSlice[<span class="number">0</span>][<span class="string">&quot;address&quot;</span>] = <span class="string">&quot;长沙&quot;</span></span><br><span class="line"><span class="keyword">for</span> index, value := <span class="keyword">range</span> mapSlice &#123;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;index:%d value:%v\n&quot;</span>, index, value)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="map中的值为切片类型"><a href="#map中的值为切片类型" class="headerlink" title="map中的值为切片类型"></a>map中的值为切片类型</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">m := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>][]<span class="type">string</span>)</span><br><span class="line">fmt.Println(m)</span><br><span class="line">val := []<span class="type">string</span>&#123;<span class="string">&quot;北京&quot;</span>, <span class="string">&quot;上海&quot;</span>&#125;</span><br><span class="line">m[<span class="string">&quot;中国&quot;</span>] = val</span><br><span class="line">fmt.Println(m)</span><br><span class="line">m[<span class="string">&quot;中国&quot;</span>] = <span class="built_in">append</span>(m[<span class="string">&quot;中国&quot;</span>], <span class="string">&quot;广州&quot;</span>, <span class="string">&quot;深圳&quot;</span>)</span><br><span class="line">fmt.Println(m)</span><br></pre></td></tr></table></figure>

<h3 id="自定义数据类型"><a href="#自定义数据类型" class="headerlink" title="自定义数据类型"></a>自定义数据类型</h3><p>假如我想用4位数字表示消息的类型</p>
<p>也用4为数字表示异常的返回值</p>
<p>如果用uint16来表示，就容易搞混</p>
<p>所以就可以自定义一个数据类型</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> msgType <span class="type">uint16</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> textMes msgType = <span class="number">1000</span></span><br><span class="line"><span class="comment">// 混用需要类型转换</span></span><br><span class="line"><span class="keyword">var</span> u1001 <span class="type">uint16</span> = <span class="number">1001</span></span><br><span class="line"><span class="keyword">var</span> imageMes msgType = msgType(u1001)</span><br><span class="line"></span><br><span class="line">fmt.Printf(<span class="string">&quot;textMes=%v, type of is %T\n&quot;</span>, textMes, textMes)</span><br><span class="line">fmt.Printf(<span class="string">&quot;imageMes =%v, type of is %T\n&quot;</span>, imageMes, imageMes )</span><br></pre></td></tr></table></figure>

<p>这个msgType 已经和uint16是属于不同的类型了</p>
<p>如果需要将uint16的变量赋值给msgType 的变量，则需要进行类型转换</p>
<h4 id="类型别名"><a href="#类型别名" class="headerlink" title="类型别名"></a>类型别名</h4><p>byte是uint8的别名</p>
<p>rune是int32的别名</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> msgType = <span class="type">uint16</span></span><br><span class="line"><span class="keyword">var</span> textMes msgType = <span class="number">1000</span></span><br><span class="line"><span class="comment">// 混用需要类型转换</span></span><br><span class="line"><span class="keyword">var</span> u1001 <span class="type">uint16</span> = <span class="number">1001</span></span><br><span class="line"><span class="keyword">var</span> imageMes msgType = u1001</span><br><span class="line"></span><br><span class="line">fmt.Printf(<span class="string">&quot;textMes=%v, type of is %T\n&quot;</span>, textMes, textMes)</span><br><span class="line">fmt.Printf(<span class="string">&quot;imageMes =%v, type of is %T\n&quot;</span>, imageMes, imageMes)</span><br></pre></td></tr></table></figure>

<p>类型别名就相当于是将uint16起了一个别的名字</p>
<p>赋值的时候也不用类型转换</p>
<h3 id="结构体"><a href="#结构体" class="headerlink" title="结构体"></a>结构体</h3><p>由一组字段构成的一种自定义数据类型</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">  Name <span class="type">string</span></span><br><span class="line">  Id <span class="type">uint32</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> u1 User = User&#123;</span><br><span class="line">  Name: <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line">u1.Id = <span class="number">10000</span></span><br></pre></td></tr></table></figure>

<h4 id="结构体字段"><a href="#结构体字段" class="headerlink" title="结构体字段"></a>结构体字段</h4><p>结构体可以没有字段</p>
<p>结构体字段通过<code>.</code>访问</p>
<h4 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">  Name     <span class="type">string</span></span><br><span class="line">  Age      <span class="type">int</span></span><br><span class="line">  password <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Account <span class="keyword">struct</span> &#123;</span><br><span class="line">  User</span><br><span class="line">  money <span class="type">float32</span></span><br><span class="line">  Name  <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">var</span> ac Account = Account&#123;</span><br><span class="line">    money: <span class="number">21.9</span>,</span><br><span class="line">    User: User&#123;</span><br><span class="line">      Name:     <span class="string">&quot;王五&quot;</span>,</span><br><span class="line">      Age:      <span class="number">21</span>,</span><br><span class="line">      password: <span class="string">&quot;978345&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    Name: <span class="string">&quot;账户1&quot;</span>,</span><br><span class="line">  &#125;</span><br><span class="line">  fmt.Printf(<span class="string">&quot;ac %#v, %T\n&quot;</span>, ac, ac)</span><br><span class="line">  <span class="keyword">var</span> u1 = User&#123;</span><br><span class="line">    Name:     <span class="string">&quot;lisa&quot;</span>,</span><br><span class="line">    Age:      <span class="number">22</span>,</span><br><span class="line">    password: <span class="string">&quot;1233fg&quot;</span>,</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> ac1 Account = Account&#123;</span><br><span class="line">    money: <span class="number">21.9</span>,</span><br><span class="line">    User:  u1,</span><br><span class="line">  &#125;</span><br><span class="line">  fmt.Printf(<span class="string">&quot;ac1 %#v, %T\n&quot;</span>, ac1, ac1)</span><br><span class="line"></span><br><span class="line">  fmt.Println(ac.money)</span><br><span class="line">  fmt.Println(ac.Name)</span><br><span class="line">  fmt.Println(ac.User.Name)</span><br><span class="line">  fmt.Println(ac.password)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">  Name     <span class="type">string</span></span><br><span class="line">  Age      <span class="type">int</span></span><br><span class="line">  password <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(u User)</span></span> PrintName() <span class="type">string</span> &#123;</span><br><span class="line">  u.Name = <span class="string">&quot;张三&quot;</span></span><br><span class="line">  fmt.Println(<span class="string">&quot;printName方法： &quot;</span>, u)</span><br><span class="line">  fmt.Printf(<span class="string">&quot;printName方法内部：%p \n&quot;</span>, &amp;u)</span><br><span class="line">  <span class="keyword">return</span> u.Name</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  user := User&#123;<span class="string">&quot;王二麻子&quot;</span>, <span class="number">23</span>, <span class="string">&quot;xsdfe23&quot;</span>&#125;</span><br><span class="line">  fmt.Printf(<span class="string">&quot;main: %p\n&quot;</span>, &amp;user)</span><br><span class="line">  name := user.PrintName() <span class="comment">// 是值传递，</span></span><br><span class="line">  fmt.Println(name, user)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="结构体指针"><a href="#结构体指针" class="headerlink" title="结构体指针"></a>结构体指针</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">  Name <span class="type">string</span></span><br><span class="line">  Id   <span class="type">uint16</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> u User = User&#123;</span><br><span class="line">  Name: <span class="string">&quot;zhangsan&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line">u.Id = <span class="number">20</span></span><br><span class="line">fmt.Println(u)</span><br><span class="line"><span class="keyword">var</span> u2 *User = &amp;User&#123;</span><br><span class="line">  Name: <span class="string">&quot;李四&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line">u2.Id = <span class="number">21</span></span><br><span class="line">fmt.Println(u2)</span><br><span class="line"></span><br><span class="line">fmt.Printf(<span class="string">&quot;u = %+v, type of %T\n&quot;</span>, u, u)</span><br><span class="line">fmt.Printf(<span class="string">&quot;u2 = %+v, type of %T\n&quot;</span>, u2, u2)</span><br></pre></td></tr></table></figure>

<h4 id="结构体指针继承"><a href="#结构体指针继承" class="headerlink" title="结构体指针继承"></a>结构体指针继承</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">  Name <span class="type">string</span></span><br><span class="line">  Id   <span class="type">uint16</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Account <span class="keyword">struct</span> &#123;</span><br><span class="line">  User</span><br><span class="line">  password <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Contact <span class="keyword">struct</span> &#123;</span><br><span class="line">  *User</span><br><span class="line">  Remark <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实例化账户</span></span><br><span class="line"><span class="keyword">var</span> a1 = Account&#123;</span><br><span class="line">  User: User&#123;</span><br><span class="line">    Name: <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">    Id:   <span class="number">1</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  password: <span class="string">&quot;666&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> c1 *Contact = &amp;Contact&#123;</span><br><span class="line">  User:   &amp;a1.User,</span><br><span class="line">  Remark: <span class="string">&quot;王麻子&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 没有重复字段就可以这样简写</span></span><br><span class="line">c1.Name = <span class="string">&quot;王五&quot;</span> <span class="comment">// 等效于  c1.User.Name = &quot;王五&quot;</span></span><br><span class="line"></span><br><span class="line">fmt.Printf(<span class="string">&quot;a1 = %+v\n&quot;</span>, a1)</span><br><span class="line">fmt.Printf(<span class="string">&quot;c1 = %+v\n&quot;</span>, c1)</span><br></pre></td></tr></table></figure>

<h4 id="结构体标签"><a href="#结构体标签" class="headerlink" title="结构体标签"></a>结构体标签</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">  Name <span class="type">string</span> <span class="string">`json:&quot;name&quot;`</span></span><br><span class="line">  Id   <span class="type">uint16</span> <span class="string">`json:&quot;id&quot;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样写好之后，结构体进行json转换的时候，Name就会自动变为name</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;encoding/json&quot;</span></span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Article <span class="keyword">struct</span> &#123;</span><br><span class="line">  Title     <span class="type">string</span> <span class="string">`json:&quot;title&quot;`</span></span><br><span class="line">  Desc      <span class="type">string</span> <span class="string">`json:&quot;desc&quot;`</span></span><br><span class="line">  Content   <span class="type">string</span> <span class="string">`json:&quot;content&quot;`</span></span><br><span class="line">  Username  <span class="type">string</span> <span class="string">`json:&quot;-&quot;`</span> <span class="comment">// - 也不参与序列化</span></span><br><span class="line">  LookCount <span class="type">int</span>    <span class="string">`json:&quot;look_count&quot;`</span></span><br><span class="line">  Free      <span class="type">bool</span>   <span class="string">`json:&quot;free&quot;`</span></span><br><span class="line">  password  <span class="type">string</span> <span class="comment">// 小写字母开头的不会参与序列化</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  article := Article&#123;</span><br><span class="line">    Title:     <span class="string">&quot;golang文档&quot;</span>,</span><br><span class="line">    Desc:      <span class="string">&quot;golang零基础入门，四小时转岗golang开发&quot;</span>,</span><br><span class="line">    Content:   <span class="string">&quot;golang零基础入门，四小时转岗golang开发&quot;</span>,</span><br><span class="line">    Username:  <span class="string">&quot;AcKnight&quot;</span>,</span><br><span class="line">    LookCount: <span class="number">1024</span>,</span><br><span class="line">    password:  <span class="string">&quot;ksd8%38&quot;</span>,</span><br><span class="line">    Free:      <span class="literal">true</span>,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 结构体转json</span></span><br><span class="line">  jsonData, err := json.Marshal(article)</span><br><span class="line">  <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    fmt.Println(err)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">  jsonStr := <span class="type">string</span>(jsonData)</span><br><span class="line">  fmt.Println(jsonStr)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们都知道golang的函数都是值传递</p>
<p>所以如果在方法中修改结构体的值</p>
<p>相当于修改的是结构体的副本</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">  Name <span class="type">string</span> <span class="string">`json:&quot;name&quot;`</span></span><br><span class="line">  Id   <span class="type">uint16</span> <span class="string">`json:&quot;id&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(u User)</span></span> SetName(name <span class="type">string</span>) &#123;</span><br><span class="line">  u.Name = name</span><br><span class="line">  fmt.Printf(<span class="string">&quot;setName修改之后：u=%+v\n&quot;</span>, u)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  u := User&#123;</span><br><span class="line">    Name: <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">    Id:   <span class="number">1001</span>,</span><br><span class="line">  &#125;</span><br><span class="line">  u.SetName(<span class="string">&quot;李四&quot;</span>)</span><br><span class="line">  fmt.Printf(<span class="string">&quot;setName运行完之后，u=%+v\n&quot;</span>, u)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果需要修改原结构体，那么需要传递的是结构体的指针</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">  Name <span class="type">string</span> <span class="string">`json:&quot;name&quot;`</span></span><br><span class="line">  Id   <span class="type">uint16</span> <span class="string">`json:&quot;id&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(u *User)</span></span> SetName(name <span class="type">string</span>) &#123;</span><br><span class="line">  (*u).Name = name</span><br><span class="line">  <span class="comment">// 也可这样简写</span></span><br><span class="line">  <span class="comment">//u.Name = name</span></span><br><span class="line">  fmt.Printf(<span class="string">&quot;setName修改之后：u=%+v\n&quot;</span>, *u)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  u := User&#123;</span><br><span class="line">    Name: <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">    Id:   <span class="number">1001</span>,</span><br><span class="line">  &#125;</span><br><span class="line">  u.SetName(<span class="string">&quot;李四&quot;</span>)</span><br><span class="line">  fmt.Printf(<span class="string">&quot;setName运行完之后，u=%+v\n&quot;</span>, u)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h3><p>特殊的数据类型</p>
<p>方法定义的合集</p>
<p>方法名(形参类型)返回值类型</p>
<p>提高代码的复用率</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Animal 定义一个animal的接口，它有唱，跳，rap的方法</span></span><br><span class="line"><span class="keyword">type</span> Animal <span class="keyword">interface</span> &#123;</span><br><span class="line">  sing()</span><br><span class="line">  jump()</span><br><span class="line">  rap()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Chicken 需要全部实现这些接口</span></span><br><span class="line"><span class="keyword">type</span> Chicken <span class="keyword">struct</span> &#123;</span><br><span class="line">  Name <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c Chicken)</span></span> sing() &#123;</span><br><span class="line">  fmt.Println(<span class="string">&quot;chicken 唱&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c Chicken)</span></span> jump() &#123;</span><br><span class="line">  fmt.Println(<span class="string">&quot;chicken 跳&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c Chicken)</span></span> rap() &#123;</span><br><span class="line">  fmt.Println(<span class="string">&quot;chicken rap&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 全部实现完之后，chicken就不再是一只普通的鸡了</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">var</span> animal Animal</span><br><span class="line"></span><br><span class="line">  animal = Chicken&#123;<span class="string">&quot;ik&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">  animal.sing()</span><br><span class="line">  animal.jump()</span><br><span class="line">  animal.rap()</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接口本身不能绑定方法</p>
<p>接口是值类型，保存的是：值+原始类型</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Animal 定义一个animal的接口，它有唱，跳，rap的方法</span></span><br><span class="line"><span class="keyword">type</span> Animal <span class="keyword">interface</span> &#123;</span><br><span class="line">  sing()</span><br><span class="line">  jump()</span><br><span class="line">  rap()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Chicken 需要全部实现这些接口</span></span><br><span class="line"><span class="keyword">type</span> Chicken <span class="keyword">struct</span> &#123;</span><br><span class="line">  Name <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c Chicken)</span></span> sing() &#123;</span><br><span class="line">  fmt.Println(<span class="string">&quot;chicken 唱&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c Chicken)</span></span> jump() &#123;</span><br><span class="line">  fmt.Println(<span class="string">&quot;chicken 跳&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c Chicken)</span></span> rap() &#123;</span><br><span class="line">  fmt.Println(<span class="string">&quot;chicken rap&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Cat 需要全部实现这些接口</span></span><br><span class="line"><span class="keyword">type</span> Cat <span class="keyword">struct</span> &#123;</span><br><span class="line">  Name <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c Cat)</span></span> sing() &#123;</span><br><span class="line">  fmt.Println(<span class="string">&quot;cat 唱&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c Cat)</span></span> jump() &#123;</span><br><span class="line">  fmt.Println(<span class="string">&quot;cat 跳&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c Cat)</span></span> rap() &#123;</span><br><span class="line">  fmt.Println(<span class="string">&quot;cat rap&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sing</span><span class="params">(obj Animal)</span></span> &#123;</span><br><span class="line">  obj.sing()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 全部实现完之后，chicken就不再是一只普通的鸡了</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  chicken := Chicken&#123;<span class="string">&quot;ik&quot;</span>&#125;</span><br><span class="line">  cat := Cat&#123;<span class="string">&quot;阿狸&quot;</span>&#125;</span><br><span class="line">  sing(chicken)</span><br><span class="line">  sing(cat)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>实现接口：</p>
<p>一个类型实现了接口的所有方法</p>
<p>即实现了该接口</p>
<h4 id="类型断言"><a href="#类型断言" class="headerlink" title="类型断言"></a>类型断言</h4><p>还原为原始类型 interface.(Type)</p>
<p>如果接口没有保存类型，则会报错</p>
<p>可返回两个值</p>
<p>value,ok :&#x3D; interface.(Type)</p>
<h4 id="空接口"><a href="#空接口" class="headerlink" title="空接口"></a>空接口</h4><p>interface{}</p>
<p>空接口可以保存任何类型</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> data <span class="keyword">interface</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Dog <span class="keyword">struct</span> &#123;</span><br><span class="line">  Name <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Print</span><span class="params">(d data)</span></span> &#123;</span><br><span class="line">  fmt.Println(d)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  d := Dog&#123;<span class="string">&quot;小黑&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">  Print(d)</span><br><span class="line"></span><br><span class="line">  Print(<span class="number">12</span>)</span><br><span class="line">  Print(<span class="string">&quot;123&quot;</span>)</span><br><span class="line">  Print(<span class="literal">true</span>)</span><br><span class="line">  Print([]<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;)</span><br><span class="line">  Print(<span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>, <span class="number">2</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="nil问题"><a href="#nil问题" class="headerlink" title="nil问题"></a>nil问题</h4><p>nil值：有类型没有值，接口本身并不是nil，可以处理</p>
<p>nil接口：既没有报错值，也没有保存类型，使用时会报错</p>
<h3 id="协程"><a href="#协程" class="headerlink" title="协程"></a>协程</h3><p>Goroutine是Go运行时管理的轻量级线程</p>
<p>主线程结束时，协程会被中断，需要有效的阻塞机制</p>
<h4 id="协程的使用"><a href="#协程的使用" class="headerlink" title="协程的使用"></a>协程的使用</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// SendCode 发送验证码</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SendCode</span><span class="params">()</span></span> &#123;</span><br><span class="line">  fmt.Println(<span class="string">&quot;发送验证码开始&quot;</span>)</span><br><span class="line">  time.Sleep(<span class="number">3</span> * time.Second)</span><br><span class="line">  fmt.Println(<span class="string">&quot;发送验证码完成！&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="comment">// 实现用户注册功能</span></span><br><span class="line">  fmt.Println(<span class="string">&quot;用户注册校验完成&quot;</span>)</span><br><span class="line">  <span class="comment">// 发送验证码</span></span><br><span class="line">  <span class="comment">//SendCode() // 会阻塞主线程</span></span><br><span class="line">  <span class="keyword">go</span> SendCode() <span class="comment">// 会阻塞主线程</span></span><br><span class="line">  fmt.Println(<span class="string">&quot;验证码已发送，请注意查收...&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>问题：</p>
<ol>
<li>主线程结束，协程也会结束</li>
<li>协程安全</li>
<li>如何获取协程函数的返回值，如何在协程中传递数据？</li>
</ol>
<h4 id="WaitGroup"><a href="#WaitGroup" class="headerlink" title="WaitGroup"></a>WaitGroup</h4><p>前面我们通过让主程序延时的方式，可以成功让协程函数顺利结束</p>
<p>但是，延时多久没人能够知道</p>
<p>所以，睡眠这种方式肯定不靠谱</p>
<p>go 自带一个WaitGroup可以解决这个问题, 代码如下</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;sync&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> wg sync.WaitGroup</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">say</span><span class="params">(s <span class="type">string</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">5</span>; i++ &#123;</span><br><span class="line">        <span class="built_in">println</span>(s)</span><br><span class="line">    &#125;</span><br><span class="line">    wg.Done()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    wg.Add(<span class="number">2</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">go</span> say(<span class="string">&quot;Hello&quot;</span>)</span><br><span class="line">    <span class="keyword">go</span> say(<span class="string">&quot;World&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    wg.Wait()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>wg.add(2)是有2个goroutine需要执行</p>
<p>wg.Done 相当于 wg.Add(-1) 意思就是我这个协程执行完了。wg.Wait() 就是告诉主线程要等一下，等他们2个都执行完再退出</p>
<h4 id="协程安全"><a href="#协程安全" class="headerlink" title="协程安全"></a>协程安全</h4><p>非常经典的例子，两个协程函数，分别对同一个全局变量进行操作</p>
<p>按照我们预期的结果，应该是200万，但是多运行几次，会发现结果各不相同</p>
<p>这就是协程安全问题</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;sync&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> w = sync.WaitGroup&#123;&#125;</span><br><span class="line"><span class="keyword">var</span> num = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">AddNum</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">1000000</span>; i++ &#123;</span><br><span class="line">    num++</span><br><span class="line">  &#125;</span><br><span class="line">  w.Done()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  w.Add(<span class="number">2</span>)</span><br><span class="line">  <span class="keyword">go</span> AddNum()</span><br><span class="line">  <span class="keyword">go</span> AddNum()</span><br><span class="line">  w.Wait()</span><br><span class="line">  fmt.Println(num)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这种情况我们可以通过加锁进行解决，go语言中给我们通过了这个方法</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;sync&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> lock = sync.Mutex&#123;&#125;</span><br><span class="line"><span class="keyword">var</span> w = sync.WaitGroup&#123;&#125;</span><br><span class="line"><span class="keyword">var</span> num = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">AddNum</span><span class="params">()</span></span> &#123;</span><br><span class="line">  lock.Lock()  <span class="comment">// 上锁</span></span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">1000000</span>; i++ &#123;</span><br><span class="line">    num++</span><br><span class="line">  &#125;</span><br><span class="line">  lock.Unlock() <span class="comment">// 解锁</span></span><br><span class="line">  w.Done() </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  w.Add(<span class="number">2</span>)</span><br><span class="line">  <span class="keyword">go</span> AddNum()</span><br><span class="line">  <span class="keyword">go</span> AddNum()</span><br><span class="line">  w.Wait()</span><br><span class="line">  fmt.Println(num)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="信道-channel"><a href="#信道-channel" class="headerlink" title="信道 channel"></a>信道 channel</h3><h4 id="声明和存取"><a href="#声明和存取" class="headerlink" title="声明和存取"></a>声明和存取</h4><p>channel，是一种带有类型的管道引用类型</p>
<p>使用前需要make(Type, (缓冲容量))</p>
<p>不带缓冲区的管道必须结合协程使用</p>
<p>可以查看长度len和容量cap</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="comment">// 声明一个string信道，容量为2</span></span><br><span class="line">  <span class="keyword">var</span> ch <span class="keyword">chan</span> <span class="type">string</span> = <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">string</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">  ch &lt;- <span class="string">&quot;AcKnight&quot;</span> <span class="comment">// 写入数据到信道中</span></span><br><span class="line">  ch &lt;- <span class="string">&quot;知道&quot;</span></span><br><span class="line"></span><br><span class="line">  s := &lt;-ch <span class="comment">// 从信道读取数据</span></span><br><span class="line">  fmt.Println(s)</span><br><span class="line">  ss, ok := &lt;-ch</span><br><span class="line">  fmt.Println(ss, ok)</span><br><span class="line"></span><br><span class="line">  <span class="built_in">close</span>(ch)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">存入：channel &lt;- value</span><br><span class="line">取出：value, (ok) &lt;- channel</span><br><span class="line">丢弃：&lt;- channel</span><br><span class="line">先进先出，自动阻塞</span><br><span class="line">数据需要保持流动，否则会阻死报错</span><br></pre></td></tr></table></figure>

<p>搭配协程使用</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">pushNum</span><span class="params">(c <span class="keyword">chan</span> <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">100</span>; i++ &#123;</span><br><span class="line">    c &lt;- i</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">close</span>(c) <span class="comment">// 写完必须要关闭，不然会死锁</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">var</span> c1 <span class="keyword">chan</span> <span class="type">int</span> = <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">2</span>) <span class="comment">// 2表示缓冲区大小</span></span><br><span class="line">  <span class="keyword">go</span> pushNum(c1)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> value := <span class="keyword">range</span> c1 &#123;</span><br><span class="line">    fmt.Println(value)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>多个协程函数，close就不能写在协程函数里了</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;sync&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ch <span class="keyword">chan</span> <span class="type">int</span> = <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">10</span>)</span><br><span class="line"><span class="keyword">var</span> wg = sync.WaitGroup&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">pushNum</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">5</span>; i++ &#123;</span><br><span class="line">    ch &lt;- i</span><br><span class="line">  &#125;</span><br><span class="line">  wg.Done()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">  wg.Add(<span class="number">2</span>)</span><br><span class="line">  <span class="keyword">go</span> pushNum()</span><br><span class="line">  <span class="keyword">go</span> pushNum()</span><br><span class="line">  wg.Wait()</span><br><span class="line">  <span class="built_in">close</span>(ch)</span><br><span class="line">  <span class="keyword">for</span> &#123;</span><br><span class="line">    res, ok := &lt;-ch</span><br><span class="line">    <span class="keyword">if</span> !ok &#123;</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(res)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="close"><a href="#close" class="headerlink" title="close"></a>close</h4><p>使用close之后就不能在继续写入了，但是还可以继续从缓冲区读取</p>
<ol>
<li>close之后，读取的chan是数据类型的默认值</li>
<li>close之后，不能再往chan里面写入数据</li>
<li>for range之前必须要close</li>
</ol>
<h4 id="可读可写"><a href="#可读可写" class="headerlink" title="可读可写"></a>可读可写</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">var</span> ch <span class="keyword">chan</span> <span class="type">int</span> = <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">2</span>)</span><br><span class="line">  <span class="comment">// 可读chan</span></span><br><span class="line">  <span class="keyword">var</span> readCh &lt;-<span class="keyword">chan</span> <span class="type">int</span> = ch</span><br><span class="line">  <span class="comment">// 可写chan</span></span><br><span class="line">  <span class="keyword">var</span> writeCh <span class="keyword">chan</span>&lt;- <span class="type">int</span> = ch</span><br><span class="line"></span><br><span class="line">  writeCh &lt;- <span class="number">1</span></span><br><span class="line">  writeCh &lt;- <span class="number">2</span></span><br><span class="line"></span><br><span class="line">  fmt.Println(&lt;-readCh)</span><br><span class="line">  fmt.Println(&lt;-readCh)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="select…case"><a href="#select…case" class="headerlink" title="select…case"></a>select…case</h4><p>适用于无法确认合适关闭信道的情况</p>
<p>通常结合for循环使用</p>
<p>select … case会阻塞到某个分支可以继续执行时执行该分支，当没有可执行的分支是执行default分支</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">var</span> ch1 <span class="keyword">chan</span> <span class="type">int</span> = <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">2</span>)</span><br><span class="line">  <span class="keyword">var</span> ch2 <span class="keyword">chan</span> <span class="type">int</span> = <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">2</span>)</span><br><span class="line">  <span class="keyword">var</span> ch3 <span class="keyword">chan</span> <span class="type">int</span> = <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">2</span>)</span><br><span class="line">  ch1 &lt;- <span class="number">1</span></span><br><span class="line">  ch2 &lt;- <span class="number">2</span></span><br><span class="line">  ch3 &lt;- <span class="number">3</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">select</span> &#123;</span><br><span class="line">  <span class="comment">// 监听多个chan的情况，是随机执行</span></span><br><span class="line">  <span class="keyword">case</span> v := &lt;-ch1:</span><br><span class="line">    fmt.Println(v)</span><br><span class="line">  <span class="keyword">case</span> v := &lt;-ch2:</span><br><span class="line">    fmt.Println(v)</span><br><span class="line">  <span class="keyword">case</span> v := &lt;-ch3:</span><br><span class="line">    fmt.Println(v)</span><br><span class="line">  <span class="keyword">default</span>:</span><br><span class="line">    fmt.Println(<span class="string">&quot;没有数据&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">PrimeNum</span><span class="params">(n <span class="type">int</span>, c <span class="keyword">chan</span> <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">2</span>; i &lt; n; i++ &#123;</span><br><span class="line">    <span class="keyword">if</span> n%i == <span class="number">0</span> &#123;</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  c &lt;- n</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  c := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>)</span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">2</span>; i &lt; <span class="number">100001</span>; i++ &#123;</span><br><span class="line">    <span class="keyword">go</span> PrimeNum(i, c)</span><br><span class="line">  &#125;</span><br><span class="line">Print:</span><br><span class="line">  <span class="keyword">for</span> &#123;</span><br><span class="line">    <span class="keyword">select</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> v := &lt;-c:</span><br><span class="line">      fmt.Printf(<span class="string">&quot;%v\t&quot;</span>, v)</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      fmt.Printf(<span class="string">&quot;所有素数都已被找到&quot;</span>)</span><br><span class="line">      <span class="keyword">break</span> Print</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="线程安全与sync-Map"><a href="#线程安全与sync-Map" class="headerlink" title="线程安全与sync.Map"></a>线程安全与sync.Map</h3><h4 id="线程安全"><a href="#线程安全" class="headerlink" title="线程安全"></a>线程安全</h4><p>什么是线程安全？</p>
<p>现在有两个协程，同时触发，一个协程对一个全局变量进行100完成++操作，另一个对全局变量—的操作</p>
<p>那么，两个协程结束，最后的值应该是0才对</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;sync&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> num <span class="type">int</span></span><br><span class="line"><span class="keyword">var</span> wait sync.WaitGroup</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">add</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">1000000</span>; i++ &#123;</span><br><span class="line">    num++</span><br><span class="line">  &#125;</span><br><span class="line">  wait.Done()</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">reduce</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">1000000</span>; i++ &#123;</span><br><span class="line">    num--</span><br><span class="line">  &#125;</span><br><span class="line">  wait.Done()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  wait.Add(<span class="number">2</span>)</span><br><span class="line">  <span class="keyword">go</span> add()</span><br><span class="line">  <span class="keyword">go</span> reduce()</span><br><span class="line">  wait.Wait()</span><br><span class="line">  fmt.Println(num)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是你会发现，这个输出的结果完全无法预测</p>
<p>这是为什么呢？</p>
<blockquote>
<p>根本原因是CPU的调度方法为抢占式执行，随机调度</p>
</blockquote>
<h4 id="同步锁"><a href="#同步锁" class="headerlink" title="同步锁"></a>同步锁</h4><p>那么我们能不能通过给操作加锁来解决这个问题呢</p>
<p>答案是可以的</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;sync&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> num <span class="type">int</span></span><br><span class="line"><span class="keyword">var</span> wait  sync.WaitGroup</span><br><span class="line"><span class="keyword">var</span> lock  sync.Mutex</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">add</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="comment">// 谁先抢到了这把锁，谁就把它锁上，一旦锁上，其他的线程就只能等着</span></span><br><span class="line">  lock.Lock()</span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">1000000</span>; i++ &#123;</span><br><span class="line">    num++</span><br><span class="line">  &#125;</span><br><span class="line">  lock.Unlock()</span><br><span class="line">  wait.Done()</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">reduce</span><span class="params">()</span></span> &#123;</span><br><span class="line">  lock.Lock()</span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">1000000</span>; i++ &#123;</span><br><span class="line">    num--</span><br><span class="line">  &#125;</span><br><span class="line">  lock.Unlock()</span><br><span class="line">  wait.Done()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  wait.Add(<span class="number">2</span>)</span><br><span class="line">  <span class="keyword">go</span> add()</span><br><span class="line">  <span class="keyword">go</span> reduce()</span><br><span class="line">  wait.Wait()</span><br><span class="line">  fmt.Println(num)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="线程安全下的map"><a href="#线程安全下的map" class="headerlink" title="线程安全下的map"></a>线程安全下的map</h4><p>如果我们在一个协程函数下，读写map就会引发一个错误</p>
<p>concurrent map read and map write</p>
<p>希望大家见到这个错误，就能知道，这个就是map的线程安全错误</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;sync&quot;</span></span><br><span class="line">  <span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> wait sync.WaitGroup</span><br><span class="line"><span class="keyword">var</span> mp = <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">reader</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">for</span> &#123;</span><br><span class="line">    fmt.Println(mp[<span class="string">&quot;time&quot;</span>])</span><br><span class="line">  &#125;</span><br><span class="line">  wait.Done()</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">writer</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">for</span> &#123;</span><br><span class="line">    mp[<span class="string">&quot;time&quot;</span>] = time.Now().Format(<span class="string">&quot;15:04:05&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  wait.Done()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  wait.Add(<span class="number">2</span>)</span><br><span class="line">  <span class="keyword">go</span> reader()</span><br><span class="line">  <span class="keyword">go</span> writer()</span><br><span class="line">  wait.Wait()</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们不能在并发模式下读写map</p>
<p>如果要这样做</p>
<ol>
<li>给读写操作加锁</li>
<li>使用sync.Map</li>
</ol>
<p>加锁</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;sync&quot;</span></span><br><span class="line">  <span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> wait sync.WaitGroup</span><br><span class="line"><span class="keyword">var</span> mp = <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>&#123;&#125;</span><br><span class="line"><span class="keyword">var</span> lock sync.Mutex</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">reader</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">for</span> &#123;</span><br><span class="line">    lock.Lock()</span><br><span class="line">    fmt.Println(mp[<span class="string">&quot;time&quot;</span>])</span><br><span class="line">    lock.Unlock()</span><br><span class="line">  &#125;</span><br><span class="line">  wait.Done()</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">writer</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">for</span> &#123;</span><br><span class="line">    lock.Lock()</span><br><span class="line">    mp[<span class="string">&quot;time&quot;</span>] = time.Now().Format(<span class="string">&quot;15:04:05&quot;</span>)</span><br><span class="line">    lock.Unlock()</span><br><span class="line">  &#125;</span><br><span class="line">  wait.Done()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  wait.Add(<span class="number">2</span>)</span><br><span class="line">  <span class="keyword">go</span> reader()</span><br><span class="line">  <span class="keyword">go</span> writer()</span><br><span class="line">  wait.Wait()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>sync.Map</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;sync&quot;</span></span><br><span class="line">  <span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> wait sync.WaitGroup</span><br><span class="line"><span class="keyword">var</span> mp = sync.Map&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">reader</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">for</span> &#123;</span><br><span class="line"></span><br><span class="line">    fmt.Println(mp.Load(<span class="string">&quot;time&quot;</span>))</span><br><span class="line">  &#125;</span><br><span class="line">  wait.Done()</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">writer</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">for</span> &#123;</span><br><span class="line">    mp.Store(<span class="string">&quot;time&quot;</span>, time.Now().Format(<span class="string">&quot;15:04:05&quot;</span>))</span><br><span class="line">  &#125;</span><br><span class="line">  wait.Done()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  wait.Add(<span class="number">2</span>)</span><br><span class="line">  <span class="keyword">go</span> reader()</span><br><span class="line">  <span class="keyword">go</span> writer()</span><br><span class="line">  wait.Wait()</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其实看它源码，它的内部也是用了同步锁的</p>
<h3 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h3><h4 id="常见的异常处理"><a href="#常见的异常处理" class="headerlink" title="常见的异常处理"></a>常见的异常处理</h4><h5 id="向上抛"><a href="#向上抛" class="headerlink" title="向上抛"></a>向上抛</h5><p>将错误交给上一级处理</p>
<p>一般是用于框架层，有些错误框架层面不能擅做决定，将错误向上抛不失为一个好的办法</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;errors&quot;</span></span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Parent</span><span class="params">()</span></span> <span class="type">error</span> &#123;</span><br><span class="line">  err := method() <span class="comment">// 遇到错误向上抛</span></span><br><span class="line">  <span class="keyword">return</span> err</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">method</span><span class="params">()</span></span> <span class="type">error</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> errors.New(<span class="string">&quot;出错了&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  fmt.Println(Parent())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="中断程序"><a href="#中断程序" class="headerlink" title="中断程序"></a>中断程序</h5><p>遇到错误直接停止程序</p>
<p>这种一般是用于初始化，一旦初始化出现错误，程序继续走下去也意义不大了，还不如中断掉</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="comment">// 读取配置文件中，结果路径错了</span></span><br><span class="line">  _, err := os.ReadFile(<span class="string">&quot;xxx&quot;</span>)</span><br><span class="line">  <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="built_in">panic</span>(err.Error())</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  fmt.Println(<span class="string">&quot;啦啦啦&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="恢复程序"><a href="#恢复程序" class="headerlink" title="恢复程序"></a>恢复程序</h5><p>我们可以在一个函数里面，使用一个defer，可以实现对panic的捕获</p>
<p>以至于出现错误不至于让程序直接崩溃</p>
<p>这种一般也是框架层的异常处理所做的</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;runtime/debug&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">read</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> err := <span class="built_in">recover</span>(); err != <span class="literal">nil</span> &#123;</span><br><span class="line">      fmt.Println(err) <span class="comment">// 捕获异常，打印错误信息</span></span><br><span class="line">      <span class="comment">// 打印错误的堆栈信息</span></span><br><span class="line">      s := <span class="type">string</span>(debug.Stack())</span><br><span class="line">      fmt.Println(s)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;()</span><br><span class="line">  <span class="keyword">var</span> list = []<span class="type">int</span>&#123;<span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line">  fmt.Println(list[<span class="number">2</span>]) <span class="comment">// 肯定会有一个panic</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">  read()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当然，这个用于捕获异常的defer的延迟函数可以在调用链路上的任何一个函数上</p>
<p>一般用于在最上层函数，捕获所有异常</p>
<h3 id="泛型"><a href="#泛型" class="headerlink" title="泛型"></a>泛型</h3><p>从1.18版本开始，Go添加了对泛型的支持，即类型参数</p>
<h4 id="泛型函数"><a href="#泛型函数" class="headerlink" title="泛型函数"></a>泛型函数</h4><p>如果我们要实现一个对int类型的求和函数</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">add</span><span class="params">(a, b <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> a + b</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是这样写了之后，如果参数是float类型，int32类型这些，就没办法使用了</p>
<p>难道要为每个类型都写一个这样的函数吗？</p>
<p>显然这就不合理</p>
<p>这个时候，泛型就上场了</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">add</span>[<span class="title">T</span> <span class="title">int</span> | <span class="title">float64</span> | <span class="title">int32</span>]<span class="params">(a, b T)</span></span> T &#123;</span><br><span class="line">  <span class="keyword">return</span> a + b</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="函数多类型泛型"><a href="#函数多类型泛型" class="headerlink" title="函数多类型泛型"></a>函数多类型泛型</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">add</span>[<span class="title">T</span> <span class="title">int</span>, <span class="title">K</span> <span class="title">string</span> | <span class="title">int</span>]<span class="params">(a T, b K)</span></span> &#123;</span><br><span class="line">    fmt.Println(a, b)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="泛型结构体"><a href="#泛型结构体" class="headerlink" title="泛型结构体"></a>泛型结构体</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;encoding/json&quot;</span></span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Response[T any] <span class="keyword">struct</span> &#123;</span><br><span class="line">  Code <span class="type">int</span>    <span class="string">`json:&quot;code&quot;`</span></span><br><span class="line">  Msg  <span class="type">string</span> <span class="string">`json:&quot;msg&quot;`</span></span><br><span class="line">  Data T      <span class="string">`json:&quot;data&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">    Name <span class="type">string</span> <span class="string">`json:&quot;name&quot;`</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">type</span> UserInfo <span class="keyword">struct</span> &#123;</span><br><span class="line">    Name <span class="type">string</span> <span class="string">`json:&quot;name&quot;`</span></span><br><span class="line">    Age  <span class="type">int</span>    <span class="string">`json:&quot;age&quot;`</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//user := Response&#123;</span></span><br><span class="line">  <span class="comment">//  Code: 0,</span></span><br><span class="line">  <span class="comment">//  Msg:  &quot;成功&quot;,</span></span><br><span class="line">  <span class="comment">//  Data: User&#123;</span></span><br><span class="line">  <span class="comment">//    Name: &quot;AcKnight&quot;,</span></span><br><span class="line">  <span class="comment">//  &#125;,</span></span><br><span class="line">  <span class="comment">//&#125;</span></span><br><span class="line">  <span class="comment">//byteData, _ := json.Marshal(user)</span></span><br><span class="line">  <span class="comment">//fmt.Println(string(byteData))</span></span><br><span class="line">  <span class="comment">//userInfo := Response&#123;</span></span><br><span class="line">  <span class="comment">//  Code: 0,</span></span><br><span class="line">  <span class="comment">//  Msg:  &quot;成功&quot;,</span></span><br><span class="line">  <span class="comment">//  Data: UserInfo&#123;</span></span><br><span class="line">  <span class="comment">//    Name: &quot;AcKnight&quot;,</span></span><br><span class="line">  <span class="comment">//    Age:  24,</span></span><br><span class="line">  <span class="comment">//  &#125;,</span></span><br><span class="line">  <span class="comment">//&#125;</span></span><br><span class="line">  <span class="comment">//byteData, _ = json.Marshal(userInfo)</span></span><br><span class="line">  <span class="comment">//fmt.Println(string(byteData))</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> userResponse Response[User]</span><br><span class="line">  json.Unmarshal([]<span class="type">byte</span>(<span class="string">`&#123;&quot;code&quot;:0,&quot;msg&quot;:&quot;成功&quot;,&quot;data&quot;:&#123;&quot;name&quot;:&quot;AcKnight&quot;&#125;&#125;`</span>), &amp;userResponse)</span><br><span class="line">  fmt.Println(userResponse.Data.Name)</span><br><span class="line">  <span class="keyword">var</span> userInfoResponse Response[UserInfo]</span><br><span class="line">  json.Unmarshal([]<span class="type">byte</span>(<span class="string">`&#123;&quot;code&quot;:0,&quot;msg&quot;:&quot;成功&quot;,&quot;data&quot;:&#123;&quot;name&quot;:&quot;AcKnight&quot;,&quot;age&quot;:24&#125;&#125;`</span>), &amp;userInfoResponse)</span><br><span class="line">  fmt.Println(userInfoResponse.Data.Name, userInfoResponse.Data.Age)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="泛型切片"><a href="#泛型切片" class="headerlink" title="泛型切片"></a>泛型切片</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> MySlice[T any] []T</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">var</span> mySlice MySlice[<span class="type">string</span>]</span><br><span class="line">  mySlice = <span class="built_in">append</span>(mySlice, <span class="string">&quot;AcKnight&quot;</span>)</span><br><span class="line">  <span class="keyword">var</span> intSlice MySlice[<span class="type">int</span>]</span><br><span class="line">  intSlice = <span class="built_in">append</span>(intSlice, <span class="number">2</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="泛型map"><a href="#泛型map" class="headerlink" title="泛型map"></a>泛型map</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> MyMap[K <span class="type">string</span> | <span class="type">int</span>, V any] <span class="keyword">map</span>[K]V</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">var</span> myMap = <span class="built_in">make</span>(MyMap[<span class="type">string</span>, <span class="type">string</span>])</span><br><span class="line">  myMap[<span class="string">&quot;name&quot;</span>] = <span class="string">&quot;AcKnight&quot;</span></span><br><span class="line">  fmt.Println(myMap)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="文件操作"><a href="#文件操作" class="headerlink" title="文件操作"></a>文件操作</h3><h4 id="文件读取"><a href="#文件读取" class="headerlink" title="文件读取"></a>文件读取</h4><h5 id="一次性读取"><a href="#一次性读取" class="headerlink" title="一次性读取"></a>一次性读取</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">byteData, _ := os.ReadFile(<span class="string">&quot;go_study/hello.txt&quot;</span>)</span><br><span class="line">fmt.Println(<span class="type">string</span>(byteData))</span><br></pre></td></tr></table></figure>

<h5 id="获取当前go文件的路径"><a href="#获取当前go文件的路径" class="headerlink" title="获取当前go文件的路径"></a>获取当前go文件的路径</h5><p>可以通过获取当前go文件的路径，然后用相对于当前go文件的路径去打开文件</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// GetCurrentFilePath 获取当前文件路径</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetCurrentFilePath</span><span class="params">()</span></span> <span class="type">string</span> &#123;</span><br><span class="line">  _, file, _, _ := runtime.Caller(<span class="number">1</span>)</span><br><span class="line">  <span class="keyword">return</span> file</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="分片读"><a href="#分片读" class="headerlink" title="分片读"></a>分片读</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">file, _ := os.Open(<span class="string">&quot;go_study/hello.txt&quot;</span>)</span><br><span class="line"><span class="keyword">defer</span> file.Close()</span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">  buf := <span class="built_in">make</span>([]<span class="type">byte</span>, <span class="number">1</span>)</span><br><span class="line">  _, err := file.Read(buf)</span><br><span class="line">  <span class="keyword">if</span> err == io.EOF &#123;</span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">  &#125;</span><br><span class="line">  fmt.Printf(<span class="string">&quot;%s&quot;</span>, buf)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="带缓冲读"><a href="#带缓冲读" class="headerlink" title="带缓冲读"></a>带缓冲读</h5><p><strong>按行读</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">file, _ := os.Open(<span class="string">&quot;go_study/hello.txt&quot;</span>)</span><br><span class="line">buf := bufio.NewReader(file)</span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">  line, _, err := buf.ReadLine()</span><br><span class="line">  fmt.Println(<span class="type">string</span>(line))</span><br><span class="line">  <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>指定分割符</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">file, _ := os.Open(<span class="string">&quot;go_study/hello.txt&quot;</span>)</span><br><span class="line">scanner := bufio.NewScanner(file)</span><br><span class="line">scanner.Split(bufio.ScanWords) <span class="comment">// 按照单词读</span></span><br><span class="line"><span class="comment">//scanner.Split(bufio.ScanLines) // 按照行读</span></span><br><span class="line"><span class="comment">//scanner.Split(bufio.ScanRunes) // 按照中文字符读</span></span><br><span class="line"><span class="comment">//scanner.Split(bufio.ScanBytes) // 按照字节读读，中文会乱码</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> scanner.Scan() &#123;</span><br><span class="line">  fmt.Println(scanner.Text())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="文件写入"><a href="#文件写入" class="headerlink" title="文件写入"></a>文件写入</h4><h5 id="一次性写入"><a href="#一次性写入" class="headerlink" title="一次性写入"></a>一次性写入</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">err := os.WriteFile(<span class="string">&quot;go_study/file1.txt&quot;</span>, []<span class="type">byte</span>(<span class="string">&quot;这是内容&quot;</span>), os.ModePerm)</span><br><span class="line">fmt.Println(err)</span><br></pre></td></tr></table></figure>

<h5 id="文件的打开方式"><a href="#文件的打开方式" class="headerlink" title="文件的打开方式"></a>文件的打开方式</h5><p><strong>常见的一些打开模式</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 如果文件不存在就创建</span></span><br><span class="line">os.O_CREATE|os.O_WRONLY</span><br><span class="line"><span class="comment">// 追加写</span></span><br><span class="line">os.O_APPEND|os.O_WRONLY</span><br><span class="line"><span class="comment">// 可读可写</span></span><br><span class="line">os.O_RDWR</span><br></pre></td></tr></table></figure>

<p><strong>完整的模式</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> (</span><br><span class="line">  O_RDONLY <span class="type">int</span> = syscall.O_RDONLY <span class="comment">// 只读</span></span><br><span class="line">  O_WRONLY <span class="type">int</span> = syscall.O_WRONLY <span class="comment">// 只写</span></span><br><span class="line">  O_RDWR   <span class="type">int</span> = syscall.O_RDWR   <span class="comment">// 读写</span></span><br><span class="line">  </span><br><span class="line">  O_APPEND <span class="type">int</span> = syscall.O_APPEND <span class="comment">// 追加</span></span><br><span class="line">  O_CREATE <span class="type">int</span> = syscall.O_CREAT  <span class="comment">// 如果不存在就创建</span></span><br><span class="line">  O_EXCL   <span class="type">int</span> = syscall.O_EXCL   <span class="comment">// 文件必须不存在</span></span><br><span class="line">  O_SYNC   <span class="type">int</span> = syscall.O_SYNC   <span class="comment">// 同步打开</span></span><br><span class="line">  O_TRUNC  <span class="type">int</span> = syscall.O_TRUNC  <span class="comment">// 打开时清空文件</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h5 id="文件的权限"><a href="#文件的权限" class="headerlink" title="文件的权限"></a>文件的权限</h5><p>主要用于linux系统，在windows下这个参数会被无视，代表文件的模式和权限位，</p>
<p>三个占位符</p>
<p>第一个是文件所有者所拥有的权限</p>
<p>第二个是文件所在组对其拥有的权限</p>
<p>第三个占位符是指其他人对文件拥有的权限</p>
<p>根据UNIX系统的权限模型，文件或目录的权限模式由三个数字表示，分别代表 所有者（Owner） 、组（Group） 和 其他用户(Other) 的权限。每个数字由三个比特位组成，分别代表读、写和执行权限。因此，对于一个mode参数值，它的每一个数字都是一个八进制数字，代表三个比特位的权限组合</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">R：读，Read的缩写，八进制值为 <span class="number">4</span>；</span><br><span class="line">W：写，Write的缩写，八进制值为 <span class="number">2</span>；</span><br><span class="line">X：执行，Execute的缩写，八进制值为 <span class="number">1</span>；</span><br></pre></td></tr></table></figure>

<p>例如</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0444</span> 表示三者均为只读的权限；</span><br><span class="line"><span class="number">0666</span> 表示三者均为“读写”的权限；</span><br><span class="line"><span class="number">0777</span> 表示三者均为读写执行的权限；</span><br><span class="line"><span class="number">0764</span> 表示所有者有读写执行（<span class="number">7</span>=<span class="number">4</span>+<span class="number">2</span>+<span class="number">1</span>）的权限，组有读写（<span class="number">6</span>=<span class="number">4</span>+<span class="number">2</span>）的权限，其他用户则为只读（<span class="number">4</span>=<span class="number">4</span>）；</span><br></pre></td></tr></table></figure>

<h5 id="文件复制"><a href="#文件复制" class="headerlink" title="文件复制"></a>文件复制</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">io.Copy(dst Writer, src Reader) (written <span class="type">int64</span>, err <span class="type">error</span>)</span><br></pre></td></tr></table></figure>

<p>将src文件的内容复制到dst文件</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">read, _ := os.Open(<span class="string">&quot;go_study/file1.txt&quot;</span>)</span><br><span class="line">write, _ := os.Create(<span class="string">&quot;go_study/file3.txt&quot;</span>) <span class="comment">// 默认是 可读可写，不存在就创建，清空文件</span></span><br><span class="line">n, err := io.Copy(write, read)</span><br><span class="line">fmt.Println(n, err)</span><br></pre></td></tr></table></figure>

<h5 id="目录操作"><a href="#目录操作" class="headerlink" title="目录操作"></a>目录操作</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dir, _ := os.ReadDir(<span class="string">&quot;go_study&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> _, entry := <span class="keyword">range</span> dir &#123;</span><br><span class="line">  info, _ := entry.Info()</span><br><span class="line">  fmt.Println(entry.Name(), info.Size()) <span class="comment">// 文件名，文件大小，单位比特</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h3><p>Go语言中自带有一个轻量级的测试框架testing和自带的go test命令来实现单元测试和性能测试，testing框架和其他语言的测试框架相似，可以基于这个框架写针对相应函数的测试用例，也可以基于该框架写相应的压力测试用例。通过单元测试，可以解决：</p>
<ol>
<li>确保每个函数是可运行，并且运行结果是正确的</li>
<li>确保写出来的代码性能是好的</li>
<li>单元测试能及时的发现程序设计或实现的逻辑错误，使问题暴露，便于问题的定位解决，而性能测试的重点在于发现程序设计上的一些问题，让程序能够在高并发的情况下还能保持稳定</li>
</ol>
<p>Go 语言推荐测试文件和源代码文件放在一块，测试文件以 <code>_test.go</code> 结尾</p>
<blockquote>
<p>需要注意的是</p>
</blockquote>
<ol>
<li>测试用例文件名必须以_test.go结尾</li>
<li>测试用例函数必须以Test开头，一般来说就是Test+被测试的函数名</li>
</ol>
<h4 id="单元测试-1"><a href="#单元测试-1" class="headerlink" title="单元测试"></a>单元测试</h4><p>例如我现在有两个用于计算的文件，叫calc.go</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Add</span><span class="params">(a <span class="type">int</span>, b <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Mul</span><span class="params">(a <span class="type">int</span>, b <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> a * b</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>那么我的测试文件就是calc_test.go</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;testing&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestAdd</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line">  <span class="keyword">if</span> ans := Add(<span class="number">1</span>, <span class="number">2</span>); ans != <span class="number">3</span> &#123;</span><br><span class="line">    <span class="comment">// 如果不符合预期，那就是测试不通过</span></span><br><span class="line">    t.Errorf(<span class="string">&quot;1 + 2 expected be 3, but %d got&quot;</span>, ans)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ans := Add(<span class="number">-10</span>, <span class="number">-20</span>); ans != <span class="number">-30</span> &#123;</span><br><span class="line">    t.Errorf(<span class="string">&quot;-10 + -20 expected be -30, but %d got&quot;</span>, ans)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试的话，就在界面上点绿色的按钮就可以了</p>
<p>如果是命令的话</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">go</span> test <span class="comment">// 可以运行某个包下的所有测试用例</span></span><br></pre></td></tr></table></figure>

<p><code>-v</code> 参数会显示每个用例的测试结果</p>
<p><code>-run</code>参数可以指定测试某个函数</p>
<p>单元测试框架提供的日志方法</p>
<table>
<thead>
<tr>
<th>方 法</th>
<th>备 注</th>
<th>测试结果</th>
</tr>
</thead>
<tbody><tr>
<td>Log</td>
<td>打印日志，同时结束测试</td>
<td>PASS</td>
</tr>
<tr>
<td>Logf</td>
<td>格式化打印日志，同时结束测试</td>
<td>PASS</td>
</tr>
<tr>
<td>Error</td>
<td>打印错误日志，同时结束测试</td>
<td>FAIL</td>
</tr>
<tr>
<td>Errorf</td>
<td>格式化打印错误日志，同时结束测试</td>
<td>FAIL</td>
</tr>
<tr>
<td>Fatal</td>
<td>打印致命日志，同时结束测试</td>
<td>FAIL</td>
</tr>
<tr>
<td>Fatalf</td>
<td>格式化打印致命日志，同时结束测试</td>
<td>FAIL</td>
</tr>
</tbody></table>
<h4 id="子测试"><a href="#子测试" class="headerlink" title="子测试"></a>子测试</h4><p>如果需要给一个函数，调用不同的测试用例，可以使用子测试</p>
<p>子测试里面的Fatal，是不会终止程序的</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;testing&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestAdd</span><span class="params">(t1 *testing.T)</span></span> &#123;</span><br><span class="line">  t1.Run(<span class="string">&quot;add1&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> ans := Add(<span class="number">1</span>, <span class="number">2</span>); ans != <span class="number">3</span> &#123;</span><br><span class="line">      <span class="comment">// 如果不符合预期，那就是测试不通过</span></span><br><span class="line">      t.Fatalf(<span class="string">&quot;1 + 2 expected be 3, but %d got&quot;</span>, ans)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  t1.Run(<span class="string">&quot;add2&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> ans := Add(<span class="number">-10</span>, <span class="number">-20</span>); ans != <span class="number">-30</span> &#123;</span><br><span class="line">      t.Fatalf(<span class="string">&quot;-10 + -20 expected be -30, but %d got&quot;</span>, ans)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果测试用例很多，还可以用一个类似表格去表示</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;testing&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestAdd</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line">  cases := []<span class="keyword">struct</span> &#123;</span><br><span class="line">    Name           <span class="type">string</span></span><br><span class="line">    A, B, Expected <span class="type">int</span></span><br><span class="line">  &#125;&#123;</span><br><span class="line">    &#123;<span class="string">&quot;a1&quot;</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;a2&quot;</span>, <span class="number">2</span>, <span class="number">-3</span>, <span class="number">-1</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;a3&quot;</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>&#125;,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> _, c := <span class="keyword">range</span> cases &#123;</span><br><span class="line">    t.Run(c.Name, <span class="function"><span class="keyword">func</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line">      <span class="keyword">if</span> ans := Add(c.A, c.B); ans != c.Expected &#123;</span><br><span class="line">        t.Fatalf(<span class="string">&quot;%d * %d expected %d, but %d got&quot;</span>,</span><br><span class="line">          c.A, c.B, c.Expected, ans)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="TestMain函数"><a href="#TestMain函数" class="headerlink" title="TestMain函数"></a>TestMain函数</h4><p>它是测试的入口</p>
<p>我们可以在TestMain里面实现测试流程的生命周期</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;os&quot;</span></span><br><span class="line">  <span class="string">&quot;testing&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试前执行</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">setup</span><span class="params">()</span></span> &#123;</span><br><span class="line">  fmt.Println(<span class="string">&quot;Before all tests&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试后执行</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">teardown</span><span class="params">()</span></span> &#123;</span><br><span class="line">  fmt.Println(<span class="string">&quot;After all tests&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Test1</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line">  fmt.Println(<span class="string">&quot;I&#x27;m test1&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Test2</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line">  fmt.Println(<span class="string">&quot;I&#x27;m test2&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 必须叫这个名字  测试主入口</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestMain</span><span class="params">(m *testing.M)</span></span> &#123;</span><br><span class="line">  <span class="comment">// 测试前执行</span></span><br><span class="line">  setup()</span><br><span class="line">  code := m.Run()</span><br><span class="line">  <span class="comment">// 测试后执行</span></span><br><span class="line">  teardown()</span><br><span class="line">  os.Exit(code)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="反射"><a href="#反射" class="headerlink" title="反射"></a>反射</h3><h4 id="类型判断"><a href="#类型判断" class="headerlink" title="类型判断"></a>类型判断</h4><p>判断一个变量是否是结构体，切片，map</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;reflect&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">refType</span><span class="params">(obj any)</span></span> &#123;</span><br><span class="line">  typeObj := reflect.TypeOf(obj)</span><br><span class="line">  fmt.Println(typeObj, typeObj.Kind())</span><br><span class="line">  <span class="comment">// 去判断具体的类型</span></span><br><span class="line">  <span class="keyword">switch</span> typeObj.Kind() &#123;</span><br><span class="line">  <span class="keyword">case</span> reflect.Slice:</span><br><span class="line">    fmt.Println(<span class="string">&quot;切片&quot;</span>)</span><br><span class="line">  <span class="keyword">case</span> reflect.Map:</span><br><span class="line">    fmt.Println(<span class="string">&quot;map&quot;</span>)</span><br><span class="line">  <span class="keyword">case</span> reflect.Struct:</span><br><span class="line">    fmt.Println(<span class="string">&quot;结构体&quot;</span>)</span><br><span class="line">  <span class="keyword">case</span> reflect.String:</span><br><span class="line">    fmt.Println(<span class="string">&quot;字符串&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  refType(<span class="keyword">struct</span> &#123;</span><br><span class="line">    Name <span class="type">string</span></span><br><span class="line">  &#125;&#123;Name: <span class="string">&quot;AcKnight&quot;</span>&#125;)</span><br><span class="line">  name := <span class="string">&quot;AcKnight&quot;</span></span><br><span class="line">  refType(name)</span><br><span class="line">  refType([]<span class="type">string</span>&#123;<span class="string">&quot;AcKnight&quot;</span>&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="通过反射获取值"><a href="#通过反射获取值" class="headerlink" title="通过反射获取值"></a>通过反射获取值</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">refValue</span><span class="params">(obj any)</span></span> &#123;</span><br><span class="line">  value := reflect.ValueOf(obj)</span><br><span class="line">  fmt.Println(value, value.Type())</span><br><span class="line">  <span class="keyword">switch</span> value.Kind() &#123;</span><br><span class="line">  <span class="keyword">case</span> reflect.Int:</span><br><span class="line">    fmt.Println(value.Int())</span><br><span class="line">  <span class="keyword">case</span> reflect.Struct:</span><br><span class="line">    fmt.Println(value.Interface())</span><br><span class="line">  <span class="keyword">case</span> reflect.String:</span><br><span class="line">    fmt.Println(value.String())</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="通过反射修改值"><a href="#通过反射修改值" class="headerlink" title="通过反射修改值"></a>通过反射修改值</h4><blockquote>
<p>注意，如果需要通过反射修改值，必须要传指针，在反射中使用Elem取指针对应的值</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">refSetValue</span><span class="params">(obj any)</span></span> &#123;</span><br><span class="line">  value := reflect.ValueOf(obj)</span><br><span class="line">  elem := value.Elem()</span><br><span class="line">  <span class="comment">// 专门取指针反射的值</span></span><br><span class="line">  <span class="keyword">switch</span> elem.Kind() &#123;</span><br><span class="line">  <span class="keyword">case</span> reflect.String:</span><br><span class="line">    elem.SetString(<span class="string">&quot;ACKNIGHT&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  name := <span class="string">&quot;AcKnight&quot;</span></span><br><span class="line">  refSetValue(&amp;name)</span><br><span class="line">  fmt.Println(name)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="结构体反射"><a href="#结构体反射" class="headerlink" title="结构体反射"></a>结构体反射</h4><p>读取json标签对应的值，如果没有就用属性的名称</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;reflect&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Student <span class="keyword">struct</span> &#123;</span><br><span class="line">  Name <span class="type">string</span></span><br><span class="line">  Age  <span class="type">int</span> <span class="string">`json:&quot;age&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  s := Student&#123;</span><br><span class="line">    Name: <span class="string">&quot;AcKnight&quot;</span>,</span><br><span class="line">    Age:  <span class="number">24</span>,</span><br><span class="line">  &#125;</span><br><span class="line">  t := reflect.TypeOf(s)</span><br><span class="line">  v := reflect.ValueOf(s)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; t.NumField(); i++ &#123;</span><br><span class="line">    field := t.Field(i)</span><br><span class="line">    jsonField := field.Tag.Get(<span class="string">&quot;json&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> jsonField == <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">      <span class="comment">// 说明json的tag是空的</span></span><br><span class="line">      jsonField = field.Name</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;Name: %s, type: %s, json: %s, value: %v\n&quot;</span>, field.Name, field.Type, jsonField, v.Field(i))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当然了，我们写的这个都很简单了，没有处理-和omitempty的情况</p>
<h4 id="修改结构体中某些值"><a href="#修改结构体中某些值" class="headerlink" title="修改结构体中某些值"></a>修改结构体中某些值</h4><p>例如，结构体tag中有big的标签，就将值大写</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;reflect&quot;</span></span><br><span class="line">  <span class="string">&quot;strings&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Student <span class="keyword">struct</span> &#123;</span><br><span class="line">  Name1 <span class="type">string</span> <span class="string">`big:&quot;-&quot;`</span></span><br><span class="line">  Name2 <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  s := Student&#123;</span><br><span class="line">    Name1: <span class="string">&quot;acknight&quot;</span>,</span><br><span class="line">    Name2: <span class="string">&quot;zhangsan&quot;</span>,</span><br><span class="line">  &#125;</span><br><span class="line">  t := reflect.TypeOf(s)</span><br><span class="line">  v := reflect.ValueOf(&amp;s).Elem()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; t.NumField(); i++ &#123;</span><br><span class="line">    field := t.Field(i)</span><br><span class="line">    bigField := field.Tag.Get(<span class="string">&quot;big&quot;</span>)</span><br><span class="line">    <span class="comment">// 判断类型是不是字符串</span></span><br><span class="line">    <span class="keyword">if</span> field.Type.Kind() != reflect.String &#123;</span><br><span class="line">      <span class="keyword">continue</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> bigField == <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">      <span class="keyword">continue</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 修改值</span></span><br><span class="line">    valueFiled := v.Field(i)</span><br><span class="line">    valueFiled.SetString(strings.ToTitle(valueFiled.String()))</span><br><span class="line">  &#125;</span><br><span class="line">  fmt.Println(s)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="调用结构体方法"><a href="#调用结构体方法" class="headerlink" title="调用结构体方法"></a>调用结构体方法</h4><p>如果结构体有call这个名字的方法，就执行它</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;reflect&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Student <span class="keyword">struct</span> &#123;</span><br><span class="line">  Name <span class="type">string</span></span><br><span class="line">  Age  <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(Student)</span></span> See(name <span class="type">string</span>) &#123;</span><br><span class="line">  fmt.Println(<span class="string">&quot;see name:&quot;</span>, name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  s := Student&#123;</span><br><span class="line">    Name: <span class="string">&quot;acknight&quot;</span>,</span><br><span class="line">    Age:  <span class="number">21</span>,</span><br><span class="line">  &#125;</span><br><span class="line">  t := reflect.TypeOf(s)</span><br><span class="line">  v := reflect.ValueOf(s)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; t.NumMethod(); i++ &#123;</span><br><span class="line">    methodType := t.Method(i)</span><br><span class="line">    fmt.Println(methodType.Name, methodType.Type)</span><br><span class="line">    <span class="keyword">if</span> methodType.Name != <span class="string">&quot;See&quot;</span> &#123;</span><br><span class="line">      <span class="keyword">continue</span></span><br><span class="line">    &#125;</span><br><span class="line">    methodValue := v.Method(i)</span><br><span class="line">    methodValue.Call([]reflect.Value&#123;</span><br><span class="line">      reflect.ValueOf(<span class="string">&quot;AcKnight&quot;</span>), <span class="comment">// 注意这里的类型</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="ORM小案例"><a href="#ORM小案例" class="headerlink" title="ORM小案例"></a>ORM小案例</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;errors&quot;</span></span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;reflect&quot;</span></span><br><span class="line">  <span class="string">&quot;strings&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Student <span class="keyword">struct</span> &#123;</span><br><span class="line">  Name <span class="type">string</span> <span class="string">`ac-orm:&quot;name&quot;`</span></span><br><span class="line">  Age  <span class="type">int</span>    <span class="string">`ac-orm:&quot;age&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> UserInfo <span class="keyword">struct</span> &#123;</span><br><span class="line">  Id   <span class="type">int</span>    <span class="string">`ac-orm:&quot;id&quot;`</span></span><br><span class="line">  Name <span class="type">string</span> <span class="string">`ac-orm:&quot;name&quot;`</span></span><br><span class="line">  Age  <span class="type">int</span>    <span class="string">`ac-orm:&quot;age&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Find</span><span class="params">(obj any, query ...any)</span></span> (sql <span class="type">string</span>, err <span class="type">error</span>) &#123;</span><br><span class="line">  <span class="comment">// Find(Student, &quot;name = ?&quot;, &quot;acknight&quot;)</span></span><br><span class="line">  <span class="comment">// 希望能够生成 select name, age from  where  name = &#x27;acknight&#x27;</span></span><br><span class="line">  t := reflect.TypeOf(obj)</span><br><span class="line">  <span class="comment">//v := reflect.ValueOf(obj)</span></span><br><span class="line">  <span class="comment">// 首先得是结构体对吧</span></span><br><span class="line">  <span class="keyword">if</span> t.Kind() != reflect.Struct &#123;</span><br><span class="line">    err = errors.New(<span class="string">&quot;非结构体&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 拿全部字段</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 拼接条件</span></span><br><span class="line">  <span class="comment">// 第二个参数，中的问号，就决定后面还能接多少参数</span></span><br><span class="line">  <span class="keyword">var</span> where <span class="type">string</span></span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">len</span>(query) &gt; <span class="number">0</span> &#123;</span><br><span class="line">    <span class="comment">// 有第二个参数，校验第二个参数中的？个数，是不是和后面的个数一样</span></span><br><span class="line">    q := query[<span class="number">0</span>] <span class="comment">// 理论上还要校验第二个参数的类型</span></span><br><span class="line">    <span class="keyword">if</span> strings.Count(q.(<span class="type">string</span>), <span class="string">&quot;?&quot;</span>)+<span class="number">1</span> != <span class="built_in">len</span>(query) &#123;</span><br><span class="line">      err = errors.New(<span class="string">&quot;参数个数不对&quot;</span>)</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 拼接where语句</span></span><br><span class="line">    <span class="comment">// 将？号带入后面的参数</span></span><br><span class="line">    <span class="keyword">for</span> _, a := <span class="keyword">range</span> query[<span class="number">1</span>:] &#123;</span><br><span class="line">      <span class="comment">// 替换q</span></span><br><span class="line">      <span class="comment">// 这里要判断a的类型</span></span><br><span class="line">      at := reflect.TypeOf(a)</span><br><span class="line">      <span class="keyword">switch</span> at.Kind() &#123;</span><br><span class="line">      <span class="keyword">case</span> reflect.Int:</span><br><span class="line">        q = strings.Replace(q.(<span class="type">string</span>), <span class="string">&quot;?&quot;</span>, fmt.Sprintf(<span class="string">&quot;%d&quot;</span>, a.(<span class="type">int</span>)), <span class="number">1</span>)</span><br><span class="line">      <span class="keyword">case</span> reflect.String:</span><br><span class="line">        q = strings.Replace(q.(<span class="type">string</span>), <span class="string">&quot;?&quot;</span>, fmt.Sprintf(<span class="string">&quot;&#x27;%s&#x27;&quot;</span>, a.(<span class="type">string</span>)), <span class="number">1</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    where += <span class="string">&quot;where &quot;</span> + q.(<span class="type">string</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 如果没有第二个参数，就是查全部</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 拼接select</span></span><br><span class="line">  <span class="comment">// 拿所有字段，取ac-orm对应的值</span></span><br><span class="line">  <span class="keyword">var</span> columns []<span class="type">string</span></span><br><span class="line">  <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; t.NumField(); i++ &#123;</span><br><span class="line">    field := t.Field(i)</span><br><span class="line">    f := field.Tag.Get(<span class="string">&quot;ac-orm&quot;</span>)</span><br><span class="line">    <span class="comment">// 不考虑是空的情况</span></span><br><span class="line">    columns = <span class="built_in">append</span>(columns, f)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 结构体的小写名字+s做表名</span></span><br><span class="line">  name := strings.ToLower(t.Name()) + <span class="string">&quot;s&quot;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 拼接最后的sql</span></span><br><span class="line">  sql = fmt.Sprintf(<span class="string">&quot;select %s from %s %s&quot;</span>, strings.Join(columns, <span class="string">&quot;,&quot;</span>), name, where)</span><br><span class="line">  <span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  sql, err := Find(Student&#123;&#125;, <span class="string">&quot;name = ? and age = ?&quot;</span>, <span class="string">&quot;acknight&quot;</span>, <span class="number">23</span>)</span><br><span class="line">  fmt.Println(sql, err) <span class="comment">// select name,age from students where name = &#x27;acknight&#x27; and age = 23</span></span><br><span class="line">  sql, err = Find(UserInfo&#123;&#125;, <span class="string">&quot;id = ?&quot;</span>, <span class="number">1</span>)</span><br><span class="line">  fmt.Println(sql, err) <span class="comment">// select id,name,age from userinfos where id = 1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果是写一下框架，偏底层工具类的操作</p>
<p>不用反射确实不太好写，但是如果是在业务上，大量使用反射就不太合适了</p>
<p>因为反射的性能没有正常代码高，会慢个一到两个数量级</p>
<p>使用反射可读性也不太好，并且也不能在编译期间发生错误</p>
<h3 id="网络编程"><a href="#网络编程" class="headerlink" title="网络编程"></a>网络编程</h3><h4 id="TCP"><a href="#TCP" class="headerlink" title="TCP"></a>TCP</h4><p>传输控制协议（<em>TCP</em>，Transmission Control Protocol）是一种面向连接的、可靠的、基于字节流的传输层通信协议</p>
<p>如何保证连接可靠呢？（面试常考题）</p>
<ol>
<li>三次握手</li>
<li>四次挥手</li>
</ol>
<h5 id="服务端"><a href="#服务端" class="headerlink" title="服务端"></a>服务端</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;io&quot;</span></span><br><span class="line">  <span class="string">&quot;net&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="comment">// 创建tcp的监听地址</span></span><br><span class="line">  tcpAddr, _ := net.ResolveTCPAddr(<span class="string">&quot;tcp&quot;</span>, <span class="string">&quot;127.0.0.1:8080&quot;</span>)</span><br><span class="line">  <span class="comment">// tcp监听</span></span><br><span class="line">  listen, _ := net.ListenTCP(<span class="string">&quot;tcp&quot;</span>, tcpAddr)</span><br><span class="line">  <span class="keyword">for</span> &#123;</span><br><span class="line">    <span class="comment">// 等待连接</span></span><br><span class="line">    conn, err := listen.AcceptTCP()</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      fmt.Println(err)</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 获取客户端的地址</span></span><br><span class="line">    fmt.Println(conn.RemoteAddr().String() + <span class="string">&quot; 进来了&quot;</span>)</span><br><span class="line">    <span class="comment">// 读取客户端传来的数据</span></span><br><span class="line">    <span class="keyword">for</span> &#123;</span><br><span class="line">      <span class="keyword">var</span> buf []<span class="type">byte</span> = <span class="built_in">make</span>([]<span class="type">byte</span>, <span class="number">1024</span>)</span><br><span class="line">      n, err := conn.Read(buf)</span><br><span class="line">      <span class="comment">// 客户端退出</span></span><br><span class="line">      <span class="keyword">if</span> err == io.EOF &#123;</span><br><span class="line">        fmt.Println(conn.RemoteAddr().String() + <span class="string">&quot; 出去了&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">      &#125;</span><br><span class="line">      fmt.Println(<span class="type">string</span>(buf[<span class="number">0</span>:n]))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="客户端"><a href="#客户端" class="headerlink" title="客户端"></a>客户端</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;net&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  conn, _ := net.DialTCP(<span class="string">&quot;tcp&quot;</span>, <span class="literal">nil</span>,</span><br><span class="line">    &amp;net.TCPAddr&#123;</span><br><span class="line">      IP:   net.ParseIP(<span class="string">&quot;127.0.0.1&quot;</span>),</span><br><span class="line">      Port: <span class="number">8080</span>&#125;)</span><br><span class="line">  <span class="keyword">var</span> s <span class="type">string</span></span><br><span class="line">  <span class="keyword">for</span> &#123;</span><br><span class="line">    fmt.Scanln(&amp;s)</span><br><span class="line">    <span class="keyword">if</span> s == <span class="string">&quot;q&quot;</span> &#123;</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    &#125;</span><br><span class="line">    conn.Write([]<span class="type">byte</span>(s))</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  conn.Close()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h4><h5 id="服务端-1"><a href="#服务端-1" class="headerlink" title="服务端"></a>服务端</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;net/http&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// handler</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handler</span><span class="params">(res http.ResponseWriter, req *http.Request)</span></span> &#123;</span><br><span class="line">  res.Write([]<span class="type">byte</span>(<span class="string">&quot;hello AcKnight&quot;</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="comment">// 回调函数</span></span><br><span class="line">  http.HandleFunc(<span class="string">&quot;/index&quot;</span>, handler)</span><br><span class="line">  <span class="comment">// 绑定服务</span></span><br><span class="line">  http.ListenAndServe(<span class="string">&quot;:8080&quot;</span>, <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;encoding/json&quot;</span></span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;io&quot;</span></span><br><span class="line">  <span class="string">&quot;net/http&quot;</span></span><br><span class="line">  <span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">IndexHandler</span><span class="params">(res http.ResponseWriter, req *http.Request)</span></span> &#123;</span><br><span class="line">  <span class="keyword">switch</span> req.Method &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">&quot;GET&quot;</span>:</span><br><span class="line">    data, err := os.ReadFile(<span class="string">&quot;acStudy/37.http/server/index.html&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      fmt.Println(data)</span><br><span class="line">    &#125;</span><br><span class="line">    res.Write(data)</span><br><span class="line">    <span class="comment">//res.Write([]byte(&quot;&lt;h1&gt;hello AcKnight GET&lt;/h1&gt;&quot;))</span></span><br><span class="line">  <span class="keyword">case</span> <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">    <span class="comment">// 获取body数据</span></span><br><span class="line">    data, err := io.ReadAll(req.Body)</span><br><span class="line">    <span class="comment">// 拿请求头</span></span><br><span class="line">    contentType := req.Header.Get(<span class="string">&quot;Content-Type&quot;</span>)</span><br><span class="line">    fmt.Println(contentType)</span><br><span class="line">    <span class="comment">//switch contentType &#123;</span></span><br><span class="line">    <span class="comment">//case &quot;application/json&quot;:</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      fmt.Println(data)</span><br><span class="line">    &#125;</span><br><span class="line">    ma := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]<span class="type">string</span>)</span><br><span class="line">    json.Unmarshal(data, &amp;ma)</span><br><span class="line">    fmt.Println(ma[<span class="string">&quot;username&quot;</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">      Username <span class="type">string</span> <span class="string">`json:&quot;username&quot;`</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> user User</span><br><span class="line">    json.Unmarshal(data, &amp;user)</span><br><span class="line">    fmt.Println(user)</span><br><span class="line">    <span class="comment">// 设置响应头</span></span><br><span class="line">    header := res.Header()</span><br><span class="line">    header[<span class="string">&quot;token&quot;</span>] = []<span class="type">string</span>&#123;<span class="string">&quot;y1gyf156sdgT%d44hjgj&quot;</span>&#125;</span><br><span class="line">    res.Write([]<span class="type">byte</span>(<span class="string">&quot;hello AcKnight POST&quot;</span>))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="comment">// 1. 绑定回调</span></span><br><span class="line">  http.HandleFunc(<span class="string">&quot;/index&quot;</span>, IndexHandler)</span><br><span class="line">  <span class="comment">// 2. 注册服务</span></span><br><span class="line">  fmt.Println(<span class="string">&quot;listen server on http://localhost:8080&quot;</span>)</span><br><span class="line">  http.ListenAndServe(<span class="string">&quot;:8080&quot;</span>, <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="客户端-1"><a href="#客户端-1" class="headerlink" title="客户端"></a>客户端</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;io&quot;</span></span><br><span class="line">  <span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="comment">// 实例化一个http客户端</span></span><br><span class="line">  client := <span class="built_in">new</span>(http.Client)</span><br><span class="line">  <span class="comment">// 构造请求对象</span></span><br><span class="line">  req, _ := http.NewRequest(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;http://localhost:8080/index&quot;</span>, <span class="literal">nil</span>)</span><br><span class="line">  <span class="comment">// 发请求</span></span><br><span class="line">  res, _ := client.Do(req)</span><br><span class="line">  <span class="comment">// 获取响应</span></span><br><span class="line">  b, _ := io.ReadAll(res.Body)</span><br><span class="line">  fmt.Println(<span class="type">string</span>(b))</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="RPC"><a href="#RPC" class="headerlink" title="RPC"></a>RPC</h3><p>远程过程调用的协议</p>
<h4 id="服务端-2"><a href="#服务端-2" class="headerlink" title="服务端"></a>服务端</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;net&quot;</span></span><br><span class="line">  <span class="string">&quot;net/http&quot;</span></span><br><span class="line">  <span class="string">&quot;net/rpc&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Server <span class="keyword">struct</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> Req <span class="keyword">struct</span> &#123;</span><br><span class="line">  Num1 <span class="type">int</span></span><br><span class="line">  Num2 <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> Res <span class="keyword">struct</span> &#123;</span><br><span class="line">  Num <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s Server)</span></span> Add(req Req, res *Res) <span class="type">error</span> &#123;</span><br><span class="line">  res.Num = req.Num1 + req.Num2</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="comment">// 注册rpc服务</span></span><br><span class="line">  rpc.Register(<span class="built_in">new</span>(Server))</span><br><span class="line">  rpc.HandleHTTP()</span><br><span class="line">  listen, err := net.Listen(<span class="string">&quot;tcp&quot;</span>, <span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">  <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    fmt.Println(err)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">  http.Serve(listen, <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="客户端-2"><a href="#客户端-2" class="headerlink" title="客户端"></a>客户端</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;net/rpc&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Req <span class="keyword">struct</span> &#123;</span><br><span class="line">  Num1 <span class="type">int</span></span><br><span class="line">  Num2 <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> Res <span class="keyword">struct</span> &#123;</span><br><span class="line">  Num <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  req := Req&#123;<span class="number">1</span>, <span class="number">2</span>&#125;</span><br><span class="line">  client, err := rpc.DialHTTP(<span class="string">&quot;tcp&quot;</span>, <span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">  <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    fmt.Println(err)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> res Res</span><br><span class="line">  client.Call(<span class="string">&quot;Server.Add&quot;</span>, req, &amp;res)</span><br><span class="line">  fmt.Println(res)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="websocket"><a href="#websocket" class="headerlink" title="websocket"></a>websocket</h3><p>websocket是<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=socket&spm=1001.2101.3001.7020">socket</a>连接和http协议的结合体，可以实现网页和服务端的长连接</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">go</span> get github.com/gorilla/websocket</span><br></pre></td></tr></table></figure>

<h4 id="服务端-3"><a href="#服务端-3" class="headerlink" title="服务端"></a>服务端</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;github.com/gorilla/websocket&quot;</span></span><br><span class="line">  <span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> UP = websocket.Upgrader&#123;</span><br><span class="line">  ReadBufferSize:  <span class="number">1024</span>,</span><br><span class="line">  WriteBufferSize: <span class="number">1024</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handler</span><span class="params">(res http.ResponseWriter, req *http.Request)</span></span> &#123;</span><br><span class="line">  <span class="comment">// 服务升级</span></span><br><span class="line">  conn, err := UP.Upgrade(res, req, <span class="literal">nil</span>)</span><br><span class="line">  <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    fmt.Println(err)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> &#123;</span><br><span class="line">    <span class="comment">// 消息类型，消息，错误</span></span><br><span class="line">    t, p, err := conn.ReadMessage()</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    &#125;</span><br><span class="line">    conn.WriteMessage(websocket.TextMessage, []<span class="type">byte</span>(fmt.Sprintf(<span class="string">&quot;你说的是：%s吗？&quot;</span>, <span class="type">string</span>(p))))</span><br><span class="line">    fmt.Println(t, <span class="type">string</span>(p))</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">defer</span> conn.Close()</span><br><span class="line">  fmt.Println(<span class="string">&quot;服务关闭&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  http.HandleFunc(<span class="string">&quot;/&quot;</span>, handler)</span><br><span class="line">  http.ListenAndServe(<span class="string">&quot;:8080&quot;</span>, <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>服务端给多个客户端发</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;github.com/gorilla/websocket&quot;</span></span><br><span class="line">  <span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> UP = websocket.Upgrader&#123;</span><br><span class="line">  ReadBufferSize:  <span class="number">1024</span>,</span><br><span class="line">  WriteBufferSize: <span class="number">1024</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> connLis []*websocket.Conn</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handler</span><span class="params">(res http.ResponseWriter, req *http.Request)</span></span> &#123;</span><br><span class="line">  <span class="comment">// 服务升级</span></span><br><span class="line">  conn, err := UP.Upgrade(res, req, <span class="literal">nil</span>)</span><br><span class="line">  <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    fmt.Println(err)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">  connLis = <span class="built_in">append</span>(connLis, conn)</span><br><span class="line">  <span class="keyword">for</span> &#123;</span><br><span class="line">    <span class="comment">// 消息类型，消息，错误</span></span><br><span class="line">    t, p, err := conn.ReadMessage()</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> index := <span class="keyword">range</span> connLis &#123;</span><br><span class="line">      connLis[index].WriteMessage(websocket.TextMessage, []<span class="type">byte</span>(fmt.Sprintf(<span class="string">&quot;你说的是：%s吗？&quot;</span>, <span class="type">string</span>(p))))</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(t, <span class="type">string</span>(p))</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">defer</span> conn.Close()</span><br><span class="line">  fmt.Println(<span class="string">&quot;服务关闭&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  http.HandleFunc(<span class="string">&quot;/&quot;</span>, handler)</span><br><span class="line">  http.ListenAndServe(<span class="string">&quot;:8080&quot;</span>, <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="客户端-3"><a href="#客户端-3" class="headerlink" title="客户端"></a>客户端</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;bufio&quot;</span></span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;github.com/gorilla/websocket&quot;</span></span><br><span class="line">  <span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  dl := websocket.Dialer&#123;&#125;</span><br><span class="line">  conn, _, err := dl.Dial(<span class="string">&quot;ws://127.0.0.1:8080&quot;</span>, <span class="literal">nil</span>)</span><br><span class="line">  <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    fmt.Println(err)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">go</span> send(conn)</span><br><span class="line">  <span class="keyword">for</span> &#123;</span><br><span class="line">    t, p, err := conn.ReadMessage()</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(t, <span class="type">string</span>(p))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">send</span><span class="params">(conn *websocket.Conn)</span></span> &#123;</span><br><span class="line">  <span class="keyword">for</span> &#123;</span><br><span class="line">    reader := bufio.NewReader(os.Stdin)</span><br><span class="line">    l, _, _ := reader.ReadLine()</span><br><span class="line">    conn.WriteMessage(websocket.TextMessage, l)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h3><p>go项目的部署特别简单，编写完成之后，只需要执行go build即可打包为可执行文件</p>
<blockquote>
<p>注意，这个操作是不同平台不一样的</p>
</blockquote>
<p>windows下打包就是exe文件，linux下打包就是二进制文件</p>
<h4 id="打包命令"><a href="#打包命令" class="headerlink" title="打包命令"></a>打包命令</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">go</span> build </span><br></pre></td></tr></table></figure>

<p>打当前目录下的main包，注意，只能有一个main函数的包</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">go</span> build xxx.<span class="keyword">go</span></span><br></pre></td></tr></table></figure>

<p>打当前目录下，xxx.go的包，这个包必须得是一个main包，不然没有效果</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">go</span> build -o main.exe xxx.<span class="keyword">go</span></span><br></pre></td></tr></table></figure>

<p>强制对输出的文件进行重命名</p>
<p>-o参数必须得在文件的前面</p>
<h4 id="交叉编译"><a href="#交叉编译" class="headerlink" title="交叉编译"></a>交叉编译</h4><p>什么是交叉编译呢，就是在windows上，我开发的go程序，我也能打包为linux上的可执行程序</p>
<p>例如在windows平台，打linux的包</p>
<blockquote>
<p>注意，执行set这个命令，一定得要是在cmd的命令行下，powershell是无效的</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">set CGO_ENABLED=<span class="number">0</span>  </span><br><span class="line">set GOOS=linux  </span><br><span class="line">set GOARCH=amd64  </span><br><span class="line"><span class="keyword">go</span> build -o main main.<span class="keyword">go</span></span><br></pre></td></tr></table></figure>

<p>CGO_ENABLED : CGO 表示 golang 中的工具，CGO_ENABLED&#x3D;0 表示 CGO 禁用，交叉编译中不能使用 CGO GOOS : 环境变量用于指定目标操作系统，mac 对应 darwin，linux 对应 linux，windows 对应 windows ，还有其它的 freebsd、android 等</p>
<p><code>GOARCH</code>：环境变量用于指定处理器的类型，386 也称 <code>x86</code> 对应 32位操作系统、<code>amd64</code> 也称 x64 对应 64 位操作系统，<code>arm</code> 这种架构一般用于嵌入式开发。比如 <code>Android</code> ， <code>iOS</code> ， <code>Win mobile</code> 等</p>
<p>为了方便呢，可以在项目的根目录下写一个bat文件</p>
<p>这样就能快速构建了</p>
<p>然后放到linux服务器下，设置文件权限就可以直接运行了</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod +x main</span><br><span class="line">./main</span><br></pre></td></tr></table></figure>

<blockquote>
<p>再次注意啊，以后打包web项目的时候，配置文件和静态文件等这些非go程序，是要一起复制到目标服务器里面的</p>
</blockquote>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">ACKnight</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2025/10/27/golang%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/">http://example.com/2025/10/27/golang%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://example.com" target="_blank">ACKNIGHT</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/golang/">golang</a></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/02/11/JAVA%E5%9F%BA%E7%A1%80%E9%9D%A2%E8%AF%95%E9%A2%98%EF%BC%88%E4%B8%8B%EF%BC%89/" title="JAVA基础面试题（下）"><img class="cover" src="/img/1738847010729.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">JAVA基础面试题（下）</div></div><div class="info-2"><div class="info-item-1">异常Exception 和 Error有什么区别？在 Java 中，所有的异常都有一个共同的祖先 java.lang 包的 Throwable 类。Throwable 类有两个重要的子类：  Exception：程序本身可以处理的异常，可以通过 catch 来进行捕获。Exception 又可分为 Checked Exception（受检查异常，必须处理）和 UnChecked Exception（不受检查异常，可以不处理）。 Error：Error 属于程序无法处理的错误，不建议通过 catch 捕获。例如 Java 虚拟机运行错误（Virtual MachineError）、虚拟机内存不够错误（OutfmeoryError）、类定义错误（noClassDefFoundError）等。这些异常发生时，Java 虚拟机（JVM）一般会选择线程终止。  Checked Exception 和 UnChecked Exception  有什么区别？Checked Exception 即 受检查异常，Java 代码在编译过程中，如果受检查异常没有被 catch 或者 throws...</div></div></div></a><a class="pagination-related" href="/2026/01/07/gin%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A0/" title="gin框架学习"><img class="cover" src="/img/1738847010729.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">gin框架学习</div></div><div class="info-2"><div class="info-item-1">官方文档 | Gin Web Framework Gin是一个非常受欢迎的Golang Web框架，在GitHub上已经有47k的星星，它和Golang的语法一样简洁明了，使得初学者得以迅速入门。 首先是安装第三方库 1go get -u github.com/gin-gonic/gin  或安装 1go install github.com/gin-gonic/gin@latest  gin初始化使用gin编写一个接口也是非常简单 123456789101112131415161718192021222324252627282930package mainimport &quot;github.com/gin-gonic/gin&quot;type Response struct &#123;	Code int    `json:&quot;code&quot;`	Msg  string `json:&quot;msg&quot;`	Data any    `json:&quot;data&quot;`&#125;func Index(c *gin.Context)...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2026/01/07/gin%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A0/" title="gin框架学习"><img class="cover" src="/img/1738847010729.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-01-07</div><div class="info-item-2">gin框架学习</div></div><div class="info-2"><div class="info-item-1">官方文档 | Gin Web Framework Gin是一个非常受欢迎的Golang Web框架，在GitHub上已经有47k的星星，它和Golang的语法一样简洁明了，使得初学者得以迅速入门。 首先是安装第三方库 1go get -u github.com/gin-gonic/gin  或安装 1go install github.com/gin-gonic/gin@latest  gin初始化使用gin编写一个接口也是非常简单 123456789101112131415161718192021222324252627282930package mainimport &quot;github.com/gin-gonic/gin&quot;type Response struct &#123;	Code int    `json:&quot;code&quot;`	Msg  string `json:&quot;msg&quot;`	Data any    `json:&quot;data&quot;`&#125;func Index(c *gin.Context)...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/Image_1548676214149460.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">ACKnight</div><div class="author-info-description">欢迎来到ACKNIGHT博客！！！</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">6</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/IMACknight"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/IMACknight" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:acknight@163.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">主要用于个人学习记录，也乐于与您分享！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Golang%E4%BB%A3%E7%90%86"><span class="toc-number">1.</span> <span class="toc-text">Golang代理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E9%87%8A"><span class="toc-number">2.</span> <span class="toc-text">注释</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%AC%E4%B9%89%E5%AD%97%E7%AC%A6"><span class="toc-number">3.</span> <span class="toc-text">转义字符</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E5%B8%B8%E7%94%A8%E8%BD%AC%E4%B9%89%E5%AD%97%E7%AC%A6"><span class="toc-number">3.1.</span> <span class="toc-text">其他常用转义字符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">3.2.</span> <span class="toc-text">格式化字符串</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E5%AE%9A%E4%B9%89"><span class="toc-number">4.</span> <span class="toc-text">变量定义</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E5%A3%B0%E6%98%8E"><span class="toc-number">4.1.</span> <span class="toc-text">变量声明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%B9%E9%87%8F%E5%A3%B0%E6%98%8E"><span class="toc-number">4.2.</span> <span class="toc-text">批量声明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E9%87%8FConstant"><span class="toc-number">4.3.</span> <span class="toc-text">常量Constant</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#iota"><span class="toc-number">4.4.</span> <span class="toc-text">iota</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F"><span class="toc-number">4.5.</span> <span class="toc-text">全局变量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E6%8C%8E%E5%8C%85%E5%8F%98%E9%87%8F"><span class="toc-number">4.6.</span> <span class="toc-text">全局挎包变量</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">5.</span> <span class="toc-text">基本数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B4%E6%95%B0%E5%9E%8B"><span class="toc-number">5.1.</span> <span class="toc-text">整数型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%AE%E7%82%B9%E5%9E%8B"><span class="toc-number">5.2.</span> <span class="toc-text">浮点型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%83%E5%B0%94%E5%9E%8B"><span class="toc-number">5.3.</span> <span class="toc-text">布尔型</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">6.</span> <span class="toc-text">运算符</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%8D%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">6.1.</span> <span class="toc-text">位运算符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B5%8B%E5%80%BC%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">6.2.</span> <span class="toc-text">赋值运算符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B3%E7%B3%BB%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">6.3.</span> <span class="toc-text">关系运算符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">6.4.</span> <span class="toc-text">逻辑运算符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E7%9F%AD%E8%B7%AF"><span class="toc-number">6.5.</span> <span class="toc-text">逻辑短路</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%B0%E5%9D%80%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">6.6.</span> <span class="toc-text">地址运算符</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E8%AF%AD%E5%8F%A5"><span class="toc-number">7.</span> <span class="toc-text">判断语句</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#if-else"><span class="toc-number">7.1.</span> <span class="toc-text">if else</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#if-else-if"><span class="toc-number">7.2.</span> <span class="toc-text">if else if</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#if-%E7%AE%80%E7%9F%AD%E8%AF%AD%E5%8F%A5"><span class="toc-number">7.3.</span> <span class="toc-text">if 简短语句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#switch-case"><span class="toc-number">7.4.</span> <span class="toc-text">switch case</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#switch-case%E4%B8%8Eif-else%E5%8C%BA%E5%88%AB"><span class="toc-number">7.5.</span> <span class="toc-text">switch case与if else区别</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#for-%E5%BE%AA%E7%8E%AF"><span class="toc-number">8.</span> <span class="toc-text">for 循环</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%A0%E7%BA%BF%E5%BE%AA%E7%8E%AF"><span class="toc-number">8.1.</span> <span class="toc-text">无线循环</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E5%BE%AA%E7%8E%AF"><span class="toc-number">8.2.</span> <span class="toc-text">条件循环</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%87%E5%87%86%E5%BE%AA%E7%8E%AF"><span class="toc-number">8.3.</span> <span class="toc-text">标准循环</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#break"><span class="toc-number">8.4.</span> <span class="toc-text">break</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#continue"><span class="toc-number">8.5.</span> <span class="toc-text">continue</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#label%E5%92%8Cgoto"><span class="toc-number">9.</span> <span class="toc-text">label和goto</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#break-1"><span class="toc-number">9.1.</span> <span class="toc-text">break</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#continue-1"><span class="toc-number">9.2.</span> <span class="toc-text">continue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#goto"><span class="toc-number">9.3.</span> <span class="toc-text">goto</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0"><span class="toc-number">10.</span> <span class="toc-text">函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="toc-number">10.1.</span> <span class="toc-text">返回值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E5%80%BC%E5%91%BD%E5%90%8D"><span class="toc-number">10.2.</span> <span class="toc-text">返回值命名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E4%B9%9F%E6%98%AF%E4%B8%80%E7%A7%8D%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">10.3.</span> <span class="toc-text">函数也是一种数据类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AB%8B%E5%8D%B3%E8%B0%83%E7%94%A8%E7%9A%84%E5%8C%BF%E5%90%8D%E5%87%BD%E6%95%B0"><span class="toc-number">10.4.</span> <span class="toc-text">立即调用的匿名函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%87%E9%92%88"><span class="toc-number">11.</span> <span class="toc-text">指针</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#defer"><span class="toc-number">12.</span> <span class="toc-text">defer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#init%E5%87%BD%E6%95%B0"><span class="toc-number">13.</span> <span class="toc-text">init函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%85"><span class="toc-number">14.</span> <span class="toc-text">包</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%85%E7%9A%84%E5%AF%BC%E5%85%A5"><span class="toc-number">14.1.</span> <span class="toc-text">包的导入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%80%E5%86%99"><span class="toc-number">14.2.</span> <span class="toc-text">简写</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B5%B7%E5%88%AB%E5%90%8D"><span class="toc-number">14.3.</span> <span class="toc-text">起别名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%A8%E9%83%A8%E5%BC%95%E5%85%A5"><span class="toc-number">14.4.</span> <span class="toc-text">全部引入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8B%E5%88%92%E7%BA%BF"><span class="toc-number">14.5.</span> <span class="toc-text">下划线_</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E7%BB%84"><span class="toc-number">15.</span> <span class="toc-text">数组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%87%E7%89%87"><span class="toc-number">16.</span> <span class="toc-text">切片</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%87%E7%89%87%E4%B8%8D%E6%98%AF%E5%AF%B9%E6%95%B0%E7%BB%84%E7%9A%84%E5%BC%95%E7%94%A8"><span class="toc-number">16.1.</span> <span class="toc-text">切片不是对数组的引用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%87%E5%90%91%E5%88%87%E7%89%87%E7%9A%84%E5%88%87%E7%89%87"><span class="toc-number">16.2.</span> <span class="toc-text">指向切片的切片</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E9%85%8D%E5%86%85%E5%AD%98%E7%A9%BA%E9%97%B4"><span class="toc-number">16.3.</span> <span class="toc-text">分配内存空间</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#map"><span class="toc-number">17.</span> <span class="toc-text">map</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A3%B0%E6%98%8E"><span class="toc-number">17.1.</span> <span class="toc-text">声明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A2%9E%E5%8A%A0"><span class="toc-number">17.2.</span> <span class="toc-text">增加</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E6%89%BE"><span class="toc-number">17.3.</span> <span class="toc-text">查找</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4"><span class="toc-number">17.4.</span> <span class="toc-text">删除</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%81%8D%E5%8E%86"><span class="toc-number">17.5.</span> <span class="toc-text">遍历</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%87%E7%89%87%E4%B8%AD%E7%9A%84%E7%B1%BB%E5%9E%8B%E4%B8%BAmap%E7%B1%BB%E5%9E%8B"><span class="toc-number">17.6.</span> <span class="toc-text">切片中的类型为map类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#map%E4%B8%AD%E7%9A%84%E5%80%BC%E4%B8%BA%E5%88%87%E7%89%87%E7%B1%BB%E5%9E%8B"><span class="toc-number">17.7.</span> <span class="toc-text">map中的值为切片类型</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">18.</span> <span class="toc-text">自定义数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E5%88%AB%E5%90%8D"><span class="toc-number">18.1.</span> <span class="toc-text">类型别名</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93"><span class="toc-number">19.</span> <span class="toc-text">结构体</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%E5%AD%97%E6%AE%B5"><span class="toc-number">19.1.</span> <span class="toc-text">结构体字段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%A7%E6%89%BF"><span class="toc-number">19.2.</span> <span class="toc-text">继承</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E6%B3%95"><span class="toc-number">19.3.</span> <span class="toc-text">方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%E6%8C%87%E9%92%88"><span class="toc-number">19.4.</span> <span class="toc-text">结构体指针</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%E6%8C%87%E9%92%88%E7%BB%A7%E6%89%BF"><span class="toc-number">19.5.</span> <span class="toc-text">结构体指针继承</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%E6%A0%87%E7%AD%BE"><span class="toc-number">19.6.</span> <span class="toc-text">结构体标签</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3"><span class="toc-number">20.</span> <span class="toc-text">接口</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E6%96%AD%E8%A8%80"><span class="toc-number">20.1.</span> <span class="toc-text">类型断言</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A9%BA%E6%8E%A5%E5%8F%A3"><span class="toc-number">20.2.</span> <span class="toc-text">空接口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#nil%E9%97%AE%E9%A2%98"><span class="toc-number">20.3.</span> <span class="toc-text">nil问题</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%8F%E7%A8%8B"><span class="toc-number">21.</span> <span class="toc-text">协程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%8F%E7%A8%8B%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">21.1.</span> <span class="toc-text">协程的使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WaitGroup"><span class="toc-number">21.2.</span> <span class="toc-text">WaitGroup</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%8F%E7%A8%8B%E5%AE%89%E5%85%A8"><span class="toc-number">21.3.</span> <span class="toc-text">协程安全</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%A1%E9%81%93-channel"><span class="toc-number">22.</span> <span class="toc-text">信道 channel</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A3%B0%E6%98%8E%E5%92%8C%E5%AD%98%E5%8F%96"><span class="toc-number">22.1.</span> <span class="toc-text">声明和存取</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#close"><span class="toc-number">22.2.</span> <span class="toc-text">close</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%AF%E8%AF%BB%E5%8F%AF%E5%86%99"><span class="toc-number">22.3.</span> <span class="toc-text">可读可写</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#select%E2%80%A6case"><span class="toc-number">22.4.</span> <span class="toc-text">select…case</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E4%B8%8Esync-Map"><span class="toc-number">23.</span> <span class="toc-text">线程安全与sync.Map</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8"><span class="toc-number">23.1.</span> <span class="toc-text">线程安全</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8C%E6%AD%A5%E9%94%81"><span class="toc-number">23.2.</span> <span class="toc-text">同步锁</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E4%B8%8B%E7%9A%84map"><span class="toc-number">23.3.</span> <span class="toc-text">线程安全下的map</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"><span class="toc-number">24.</span> <span class="toc-text">异常处理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"><span class="toc-number">24.1.</span> <span class="toc-text">常见的异常处理</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%90%91%E4%B8%8A%E6%8A%9B"><span class="toc-number">24.1.1.</span> <span class="toc-text">向上抛</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%AD%E6%96%AD%E7%A8%8B%E5%BA%8F"><span class="toc-number">24.1.2.</span> <span class="toc-text">中断程序</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%81%A2%E5%A4%8D%E7%A8%8B%E5%BA%8F"><span class="toc-number">24.1.3.</span> <span class="toc-text">恢复程序</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B"><span class="toc-number">25.</span> <span class="toc-text">泛型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B%E5%87%BD%E6%95%B0"><span class="toc-number">25.1.</span> <span class="toc-text">泛型函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E5%A4%9A%E7%B1%BB%E5%9E%8B%E6%B3%9B%E5%9E%8B"><span class="toc-number">25.2.</span> <span class="toc-text">函数多类型泛型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B%E7%BB%93%E6%9E%84%E4%BD%93"><span class="toc-number">25.3.</span> <span class="toc-text">泛型结构体</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B%E5%88%87%E7%89%87"><span class="toc-number">25.4.</span> <span class="toc-text">泛型切片</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8Bmap"><span class="toc-number">25.5.</span> <span class="toc-text">泛型map</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C"><span class="toc-number">26.</span> <span class="toc-text">文件操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96"><span class="toc-number">26.1.</span> <span class="toc-text">文件读取</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80%E6%AC%A1%E6%80%A7%E8%AF%BB%E5%8F%96"><span class="toc-number">26.1.1.</span> <span class="toc-text">一次性读取</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8Dgo%E6%96%87%E4%BB%B6%E7%9A%84%E8%B7%AF%E5%BE%84"><span class="toc-number">26.1.2.</span> <span class="toc-text">获取当前go文件的路径</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%86%E7%89%87%E8%AF%BB"><span class="toc-number">26.1.3.</span> <span class="toc-text">分片读</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B8%A6%E7%BC%93%E5%86%B2%E8%AF%BB"><span class="toc-number">26.1.4.</span> <span class="toc-text">带缓冲读</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5"><span class="toc-number">26.2.</span> <span class="toc-text">文件写入</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80%E6%AC%A1%E6%80%A7%E5%86%99%E5%85%A5"><span class="toc-number">26.2.1.</span> <span class="toc-text">一次性写入</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%9A%84%E6%89%93%E5%BC%80%E6%96%B9%E5%BC%8F"><span class="toc-number">26.2.2.</span> <span class="toc-text">文件的打开方式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%9A%84%E6%9D%83%E9%99%90"><span class="toc-number">26.2.3.</span> <span class="toc-text">文件的权限</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%A4%8D%E5%88%B6"><span class="toc-number">26.2.4.</span> <span class="toc-text">文件复制</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C"><span class="toc-number">26.2.5.</span> <span class="toc-text">目录操作</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95"><span class="toc-number">27.</span> <span class="toc-text">单元测试</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95-1"><span class="toc-number">27.1.</span> <span class="toc-text">单元测试</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%90%E6%B5%8B%E8%AF%95"><span class="toc-number">27.2.</span> <span class="toc-text">子测试</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#TestMain%E5%87%BD%E6%95%B0"><span class="toc-number">27.3.</span> <span class="toc-text">TestMain函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84"><span class="toc-number">28.</span> <span class="toc-text">反射</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E5%88%A4%E6%96%AD"><span class="toc-number">28.1.</span> <span class="toc-text">类型判断</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E5%8F%8D%E5%B0%84%E8%8E%B7%E5%8F%96%E5%80%BC"><span class="toc-number">28.2.</span> <span class="toc-text">通过反射获取值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E5%8F%8D%E5%B0%84%E4%BF%AE%E6%94%B9%E5%80%BC"><span class="toc-number">28.3.</span> <span class="toc-text">通过反射修改值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%E5%8F%8D%E5%B0%84"><span class="toc-number">28.4.</span> <span class="toc-text">结构体反射</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E7%BB%93%E6%9E%84%E4%BD%93%E4%B8%AD%E6%9F%90%E4%BA%9B%E5%80%BC"><span class="toc-number">28.5.</span> <span class="toc-text">修改结构体中某些值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E7%BB%93%E6%9E%84%E4%BD%93%E6%96%B9%E6%B3%95"><span class="toc-number">28.6.</span> <span class="toc-text">调用结构体方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ORM%E5%B0%8F%E6%A1%88%E4%BE%8B"><span class="toc-number">28.7.</span> <span class="toc-text">ORM小案例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B"><span class="toc-number">29.</span> <span class="toc-text">网络编程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#TCP"><span class="toc-number">29.1.</span> <span class="toc-text">TCP</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF"><span class="toc-number">29.1.1.</span> <span class="toc-text">服务端</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-number">29.1.2.</span> <span class="toc-text">客户端</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTTP"><span class="toc-number">29.2.</span> <span class="toc-text">HTTP</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF-1"><span class="toc-number">29.2.1.</span> <span class="toc-text">服务端</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF-1"><span class="toc-number">29.2.2.</span> <span class="toc-text">客户端</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RPC"><span class="toc-number">30.</span> <span class="toc-text">RPC</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF-2"><span class="toc-number">30.1.</span> <span class="toc-text">服务端</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF-2"><span class="toc-number">30.2.</span> <span class="toc-text">客户端</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#websocket"><span class="toc-number">31.</span> <span class="toc-text">websocket</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF-3"><span class="toc-number">31.1.</span> <span class="toc-text">服务端</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF-3"><span class="toc-number">31.2.</span> <span class="toc-text">客户端</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2"><span class="toc-number">32.</span> <span class="toc-text">部署</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%93%E5%8C%85%E5%91%BD%E4%BB%A4"><span class="toc-number">32.1.</span> <span class="toc-text">打包命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91"><span class="toc-number">32.2.</span> <span class="toc-text">交叉编译</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2026/01/07/gin%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A0/" title="gin框架学习"><img src="/img/1738847010729.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="gin框架学习"/></a><div class="content"><a class="title" href="/2026/01/07/gin%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A0/" title="gin框架学习">gin框架学习</a><time datetime="2026-01-07T13:13:44.000Z" title="发表于 2026-01-07 21:13:44">2026-01-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/10/27/golang%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/" title="golang基础学习"><img src="/img/1738847010729.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="golang基础学习"/></a><div class="content"><a class="title" href="/2025/10/27/golang%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/" title="golang基础学习">golang基础学习</a><time datetime="2025-10-27T14:07:19.000Z" title="发表于 2025-10-27 22:07:19">2025-10-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/02/11/JAVA%E5%9F%BA%E7%A1%80%E9%9D%A2%E8%AF%95%E9%A2%98%EF%BC%88%E4%B8%8B%EF%BC%89/" title="JAVA基础面试题（下）"><img src="/img/1738847010729.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="JAVA基础面试题（下）"/></a><div class="content"><a class="title" href="/2025/02/11/JAVA%E5%9F%BA%E7%A1%80%E9%9D%A2%E8%AF%95%E9%A2%98%EF%BC%88%E4%B8%8B%EF%BC%89/" title="JAVA基础面试题（下）">JAVA基础面试题（下）</a><time datetime="2025-02-11T03:52:17.000Z" title="发表于 2025-02-11 11:52:17">2025-02-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/02/10/JAVA%E5%9F%BA%E7%A1%80%E9%9D%A2%E8%AF%95%E9%A2%98%EF%BC%88%E4%B8%AD%EF%BC%89/" title="JAVA基础面试题（中）"><img src="/img/1738847010729.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="JAVA基础面试题（中）"/></a><div class="content"><a class="title" href="/2025/02/10/JAVA%E5%9F%BA%E7%A1%80%E9%9D%A2%E8%AF%95%E9%A2%98%EF%BC%88%E4%B8%AD%EF%BC%89/" title="JAVA基础面试题（中）">JAVA基础面试题（中）</a><time datetime="2025-02-10T02:50:03.000Z" title="发表于 2025-02-10 10:50:03">2025-02-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/02/08/%E6%89%8B%E5%86%99-RPC-%E6%A1%86%E6%9E%B6/" title="手写 RPC 框架"><img src="/img/1738847010729.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="手写 RPC 框架"/></a><div class="content"><a class="title" href="/2025/02/08/%E6%89%8B%E5%86%99-RPC-%E6%A1%86%E6%9E%B6/" title="手写 RPC 框架">手写 RPC 框架</a><time datetime="2025-02-08T08:13:13.000Z" title="发表于 2025-02-08 16:13:13">2025-02-08</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2026 By ACKnight</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>